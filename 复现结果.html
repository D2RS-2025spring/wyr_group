<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>quarto-input4c0559f9c5f04ffa</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="复现结果_files/libs/clipboard/clipboard.min.js"></script>
<script src="复现结果_files/libs/quarto-html/quarto.js"></script>
<script src="复现结果_files/libs/quarto-html/popper.min.js"></script>
<script src="复现结果_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="复现结果_files/libs/quarto-html/anchor.min.js"></script>
<link href="复现结果_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="复现结果_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="复现结果_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="复现结果_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="复现结果_files/libs/bootstrap/bootstrap-1bc8a17f135ab3d594c857e9f48e611b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">################################################# Processing  ##########################################</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>traits <span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"D:/研究生学习资料/NutNet_Article-1.0.0/NutNet_Article-1.0.0/output/biomass_core_leaf_spei_final.csv"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">########################################################################################################</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(traits)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "X"                        "site_code"               
  [3] "year"                     "block"                   
  [5] "plot"                     "trt"                     
  [7] "Family"                   "Taxon"                   
  [9] "num_leaves"               "leaf_pct_N"              
 [11] "leaf_pct_C"               "leaf_N15_delta_air"      
 [13] "leaf_C13_delta_PDB"       "leaf_N15_pct_atom"       
 [15] "leaf_C13_pct_atom"        "leaf_area_mm2"           
 [17] "leaf_dry_mass_g"          "SLA"                     
 [19] "leaf_ppm_P"               "leaf_ppm_B"              
 [21] "leaf_ppm_Na"              "leaf_ppm_Ca"             
 [23] "leaf_ppm_Fe"              "leaf_ppm_K"              
 [25] "leaf_ppm_Mg"              "leaf_ppm_Mn"             
 [27] "leaf_ppm_Cu"              "leaf_ppm_Zn"             
 [29] "leaf_ppm_Sr"              "leaf_ppm_Pb"             
 [31] "leaf_ppm_Mo"              "SLA_v2"                  
 [33] "first_nutrient_year"      "first_fenced_year"       
 [35] "year_trt"                 "soil_pctN"               
 [37] "soil_ppmP"                "Soil_ppmK"               
 [39] "max_cover"                "Ntrt"                    
 [41] "Ptrt"                     "Ktrt"                    
 [43] "Nfix"                     "sum_INT_cover"           
 [45] "sum_NAT_cover"            "sum_UNK_cover"           
 [47] "total_cover"              "INT_rich"                
 [49] "NAT_rich"                 "UNK_rich"                
 [51] "rich"                     "site_year_rich"          
 [53] "site_richness"            "site_native_richness"    
 [55] "site_introduced_richness" "plot_beta"               
 [57] "dead_mass"                "live_mass"               
 [59] "total_mass"               "unsorted_mass"           
 [61] "proportion_par"           "Ambient_PAR"             
 [63] "Ground_PAR"               "LAI"                     
 [65] "par_rat"                  "site_name"               
 [67] "continent"                "country"                 
 [69] "region"                   "managed"                 
 [71] "burned"                   "grazed"                  
 [73] "anthropogenic"            "habitat"                 
 [75] "elevation"                "latitude"                
 [77] "longitude"                "experiment_type"         
 [79] "N"                        "P"                       
 [81] "K"                        "Exclose"                 
 [83] "X.x"                      "precip"                  
 [85] "PET"                      "SPEI_12"                 
 [87] "SPEI_6"                   "SPEI_24"                 
 [89] "SPEI_12.class"            "SPEI_6.class"            
 [91] "SPEI_24.class"            "precip.mean"             
 [93] "PET.mean"                 "p_pet"                   
 [95] "tmp"                      "par"                     
 [97] "vpd"                      "z"                       
 [99] "provenance"               "lifespan"                
[101] "lifeform"                 "functional_group"        
[103] "photosynthetic_pathway"   "n"                       
[105] "X.y"                      "pre2_gs"                 
[107] "tmp2_gs"                  "vpd2_gs"                 
[109] "par2_gs"                  "alpha"                   
[111] "subplot"                  "mass"                    
[113] "category"                 "live"                    
[115] "pct_C"                    "pct_N"                   
[117] "pct_P"                    "pct_K"                   
[119] "pct_Mg"                   "pct_Ca"                  
[121] "Ntrt_fac"                 "Ptrt_fac"                
[123] "Ktrt_fac"                 "AGN"                     
[125] "gs_len"                   "gs_frac"                 
[127] "start_date"               "end_date"                
[129] "soil.moisture_m3m3_era5"  "soil_classification"     
[131] "classication_source"      "wilting_point_SR2006"    
[133] "field_capacity_SR2006"    "TEWmax"                  
[135] "TEW"                      "REW"                     
[137] "REW_corr"                </code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(traits) <span class="co"># 2788</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2788</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>Ntrt_fac <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(traits<span class="sc">$</span>Ntrt)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>Ptrt_fac <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(traits<span class="sc">$</span>Ptrt)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>Ktrt_fac <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(traits<span class="sc">$</span>Ktrt)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>block_fac <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(traits<span class="sc">$</span>block)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>trt_fac <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(traits<span class="sc">$</span>trt)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="do">## add in photosynthetic pathway information</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(<span class="fu">as.factor</span>(traits<span class="sc">$</span>Family)) <span class="co"># check Amaranthaceae, Asteraceae, Boraginaceae, Caryophyllaceae, Cyperaceae, Euphorbiaceae,</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Amaranthaceae"    "Apiaceae"         "Apocynaceae"      "Asteraceae"      
 [5] "Boraginaceae"     "Brassicaceae"     "Caprifoliaceae"   "Caryophyllaceae" 
 [9] "Cistaceae"        "Convolvulaceae"   "Cyperaceae"       "Euphorbiaceae"   
[13] "Fabaceae"         "Geraniaceae"      "Hamamelidaceae"   "Iridaceae"       
[17] "Juncaceae"        "Lamiaceae"        "Malvaceae"        "Montiaceae"      
[21] "Onagraceae"       "Orobanchaceae"    "Plantaginaceae"   "Poaceae"         
[25] "Polemoniaceae"    "Polygonaceae"     "Proteaceae"       "Ranunculaceae"   
[29] "Rosaceae"         "Rubiaceae"        "Scrophulariaceae" "Solanaceae"      
[33] "Verbenaceae"      "Violaceae"       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Polygonaceae, Poaceae, Scrophulariaceae</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># only one!</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># C4</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#traits$photosynthetic_pathway ='NULL'</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>photosynthetic_pathway[traits<span class="sc">$</span>photosynthetic_pathway <span class="sc">==</span> <span class="st">'NULL'</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">&amp;</span> traits<span class="sc">$</span>Family <span class="sc">==</span> <span class="st">'Cyperaceae'</span> <span class="sc">&amp;</span> traits<span class="sc">$</span>Taxon <span class="sc">==</span> <span class="st">'FIMBRISTYLIS DICHOTOMA'</span>] <span class="ot">&lt;-</span> <span class="st">'C4'</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>photosynthetic_pathway[traits<span class="sc">$</span>photosynthetic_pathway <span class="sc">==</span> <span class="st">'NULL'</span>] <span class="ot">&lt;-</span> <span class="st">'C3'</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(traits<span class="sc">$</span>photosynthetic_pathway)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  C3   C4 
2267  521 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## C4 : 521</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="do">## C3: 2267</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="do">### calculate SLA #############</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>sla_m2_g <span class="ot">=</span> traits<span class="sc">$</span>SLA_v2 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">1000000</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(traits<span class="sc">$</span>sla_m2_g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">### calculate LMA #############</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>lma <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>traits<span class="sc">$</span>sla_m2_g</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(traits<span class="sc">$</span>lma) <span class="co"># some extremely high values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">### calculate narea #############</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>narea <span class="ot">=</span> (traits<span class="sc">$</span>leaf_pct_N <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">*</span> (traits<span class="sc">$</span>lma)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(traits<span class="sc">$</span>narea) <span class="co"># some extremely high values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-1-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">### calculate nmass #############</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>nmass <span class="ot">=</span> traits<span class="sc">$</span>leaf_pct_N</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(traits<span class="sc">$</span>nmass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-1-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(traits<span class="sc">$</span>leaf_pct_N)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-1-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">### calculate N: P ratio in leaves #############</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>leaf_pct_P <span class="ot">=</span> traits<span class="sc">$</span>leaf_ppm_P<span class="sc">/</span><span class="dv">10000</span> <span class="do">## transform into percentage</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>leaf_N_P <span class="ot">=</span> traits<span class="sc">$</span>leaf_pct_N<span class="sc">/</span>traits<span class="sc">$</span>leaf_pct_P</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="do">### calculate C: N ratio in leaves #############</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>leaf_N_C <span class="ot">=</span> traits<span class="sc">$</span>leaf_pct_C<span class="sc">/</span>traits<span class="sc">$</span>leaf_pct_N</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="do">### calculate lai per plot #############</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>lai <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>(traits<span class="sc">$</span>Ground_PAR <span class="sc">/</span> traits<span class="sc">$</span>Ambient_PAR) <span class="sc">/</span> <span class="fl">0.86</span> <span class="co"># from: http://manuals.decagon.com/Manuals/10242_Accupar%20LP80_Web.pdf page 41</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(traits<span class="sc">$</span>lai)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-1-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">### calculate par per leaf area to assume par absorbed is reduced in dense canopies: calculation per plot</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>par_per_leaf_area <span class="ot">=</span> traits<span class="sc">$</span>par2_gs <span class="sc">*</span> ((<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> traits<span class="sc">$</span>lai)) <span class="sc">/</span> traits<span class="sc">$</span>lai) <span class="co"># from Dong et al. (2007) eqn 2</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(traits<span class="sc">$</span>par_per_leaf_area)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-1-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">### calculate biomass for each species depending on the percentage max-cover for each species ###############</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>spp_live_mass <span class="ot">=</span> traits<span class="sc">$</span>live_mass <span class="sc">*</span> (traits<span class="sc">$</span>max_cover <span class="sc">/</span> <span class="dv">100</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(traits<span class="sc">$</span>spp_live_mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-1-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## calculate big delta C13 from small delta </span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>delta <span class="ot">=</span> ((<span class="sc">-</span><span class="fl">0.008</span> <span class="sc">-</span> traits<span class="sc">$</span>leaf_C13_delta_PDB <span class="sc">*</span> <span class="fl">0.001</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> traits<span class="sc">$</span>leaf_C13_delta_PDB <span class="sc">*</span> <span class="fl">0.001</span>)) <span class="sc">*</span> <span class="dv">1000</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(traits<span class="sc">$</span>delta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-1-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">##### calculate chi for C3 plants #################### </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>chi[traits<span class="sc">$</span>photosynthetic_pathway <span class="sc">==</span> <span class="st">'C3'</span>] <span class="ot">=</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  (traits<span class="sc">$</span>delta[traits<span class="sc">$</span>photosynthetic_pathway <span class="sc">==</span> <span class="st">'C3'</span>] <span class="sc">*</span> <span class="fl">0.001</span> <span class="sc">-</span> <span class="fl">0.0044</span>) <span class="sc">/</span> (<span class="fl">0.027</span> <span class="sc">-</span> <span class="fl">0.0044</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(traits<span class="sc">$</span>chi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-1-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">##### calculate chi for C4 plants #################### </span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>chi[traits<span class="sc">$</span>photosynthetic_pathway <span class="sc">==</span> <span class="st">'C4'</span>] <span class="ot">=</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  (traits<span class="sc">$</span>delta[traits<span class="sc">$</span>photosynthetic_pathway <span class="sc">==</span> <span class="st">'C4'</span>] <span class="sc">*</span> <span class="fl">0.001</span> <span class="sc">-</span> <span class="fl">0.0044</span>) <span class="sc">/</span> ((<span class="sc">-</span><span class="fl">0.0057</span> <span class="sc">+</span> <span class="fl">0.03</span><span class="sc">*</span><span class="fl">0.4</span>) <span class="sc">-</span> <span class="fl">0.0044</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(traits<span class="sc">$</span>chi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-1-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### create a new column for fence #################</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>fence <span class="ot">&lt;-</span> <span class="st">'no'</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>fence[traits<span class="sc">$</span>trt <span class="sc">==</span> <span class="st">'Fence'</span> <span class="sc">|</span> traits<span class="sc">$</span>trt <span class="sc">==</span> <span class="st">'NPK+Fence'</span>] <span class="ot">&lt;-</span> <span class="st">'yes'</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="do">################### transform some variables into log to get normal distribution #####################################</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>loglma <span class="ot">&lt;-</span> <span class="fu">log</span>(traits<span class="sc">$</span>lma)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(traits<span class="sc">$</span>loglma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-1-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>lognarea <span class="ot">&lt;-</span> <span class="fu">log</span>(traits<span class="sc">$</span>narea)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(traits<span class="sc">$</span>lognarea)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-1-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>lognmass <span class="ot">&lt;-</span> <span class="fu">log</span>(traits<span class="sc">$</span>nmass)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(traits<span class="sc">$</span>lognmass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-1-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(traits)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "X"                        "site_code"               
  [3] "year"                     "block"                   
  [5] "plot"                     "trt"                     
  [7] "Family"                   "Taxon"                   
  [9] "num_leaves"               "leaf_pct_N"              
 [11] "leaf_pct_C"               "leaf_N15_delta_air"      
 [13] "leaf_C13_delta_PDB"       "leaf_N15_pct_atom"       
 [15] "leaf_C13_pct_atom"        "leaf_area_mm2"           
 [17] "leaf_dry_mass_g"          "SLA"                     
 [19] "leaf_ppm_P"               "leaf_ppm_B"              
 [21] "leaf_ppm_Na"              "leaf_ppm_Ca"             
 [23] "leaf_ppm_Fe"              "leaf_ppm_K"              
 [25] "leaf_ppm_Mg"              "leaf_ppm_Mn"             
 [27] "leaf_ppm_Cu"              "leaf_ppm_Zn"             
 [29] "leaf_ppm_Sr"              "leaf_ppm_Pb"             
 [31] "leaf_ppm_Mo"              "SLA_v2"                  
 [33] "first_nutrient_year"      "first_fenced_year"       
 [35] "year_trt"                 "soil_pctN"               
 [37] "soil_ppmP"                "Soil_ppmK"               
 [39] "max_cover"                "Ntrt"                    
 [41] "Ptrt"                     "Ktrt"                    
 [43] "Nfix"                     "sum_INT_cover"           
 [45] "sum_NAT_cover"            "sum_UNK_cover"           
 [47] "total_cover"              "INT_rich"                
 [49] "NAT_rich"                 "UNK_rich"                
 [51] "rich"                     "site_year_rich"          
 [53] "site_richness"            "site_native_richness"    
 [55] "site_introduced_richness" "plot_beta"               
 [57] "dead_mass"                "live_mass"               
 [59] "total_mass"               "unsorted_mass"           
 [61] "proportion_par"           "Ambient_PAR"             
 [63] "Ground_PAR"               "LAI"                     
 [65] "par_rat"                  "site_name"               
 [67] "continent"                "country"                 
 [69] "region"                   "managed"                 
 [71] "burned"                   "grazed"                  
 [73] "anthropogenic"            "habitat"                 
 [75] "elevation"                "latitude"                
 [77] "longitude"                "experiment_type"         
 [79] "N"                        "P"                       
 [81] "K"                        "Exclose"                 
 [83] "X.x"                      "precip"                  
 [85] "PET"                      "SPEI_12"                 
 [87] "SPEI_6"                   "SPEI_24"                 
 [89] "SPEI_12.class"            "SPEI_6.class"            
 [91] "SPEI_24.class"            "precip.mean"             
 [93] "PET.mean"                 "p_pet"                   
 [95] "tmp"                      "par"                     
 [97] "vpd"                      "z"                       
 [99] "provenance"               "lifespan"                
[101] "lifeform"                 "functional_group"        
[103] "photosynthetic_pathway"   "n"                       
[105] "X.y"                      "pre2_gs"                 
[107] "tmp2_gs"                  "vpd2_gs"                 
[109] "par2_gs"                  "alpha"                   
[111] "subplot"                  "mass"                    
[113] "category"                 "live"                    
[115] "pct_C"                    "pct_N"                   
[117] "pct_P"                    "pct_K"                   
[119] "pct_Mg"                   "pct_Ca"                  
[121] "Ntrt_fac"                 "Ptrt_fac"                
[123] "Ktrt_fac"                 "AGN"                     
[125] "gs_len"                   "gs_frac"                 
[127] "start_date"               "end_date"                
[129] "soil.moisture_m3m3_era5"  "soil_classification"     
[131] "classication_source"      "wilting_point_SR2006"    
[133] "field_capacity_SR2006"    "TEWmax"                  
[135] "TEW"                      "REW"                     
[137] "REW_corr"                 "block_fac"               
[139] "trt_fac"                  "sla_m2_g"                
[141] "lma"                      "narea"                   
[143] "nmass"                    "leaf_pct_P"              
[145] "leaf_N_P"                 "leaf_N_C"                
[147] "lai"                      "par_per_leaf_area"       
[149] "spp_live_mass"            "delta"                   
[151] "chi"                      "fence"                   
[153] "loglma"                   "lognarea"                
[155] "lognmass"                </code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>log_spp_live_mass <span class="ot">&lt;-</span> <span class="fu">log</span>(traits<span class="sc">$</span>spp_live_mass)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(traits<span class="sc">$</span>log_spp_live_mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-1-15.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>traits<span class="sc">$</span>aridity <span class="ot">&lt;-</span> traits<span class="sc">$</span>p_pet</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="do">#################### exclude C points where chi is higher than 0.1 and lower than 0.95 ######### </span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>traits_chi_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(traits, chi <span class="sc">&gt;</span> <span class="fl">0.1</span> <span class="sc">&amp;</span> chi <span class="sc">&lt;</span> <span class="fl">0.95</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(traits_chi_sub) <span class="do">### 2106</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2106</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(traits_chi_sub<span class="sc">$</span>pft) <span class="do">### 162 C4 remains </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt; table of extent 0 &gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(traits_chi_sub<span class="sc">$</span>chi) <span class="co"># quasi normal distribution </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-1-16.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(traits_chi_sub<span class="sc">$</span>p_pet) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-1-17.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(traits_chi_sub) <span class="co"># 2106</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2106</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(traits_chi_sub<span class="sc">$</span>chi) <span class="co"># 0.114 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1148982</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(traits_chi_sub<span class="sc">$</span>chi) <span class="co"># 0.938</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9389573</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(traits_chi_sub<span class="sc">$</span>Taxon)) <span class="co"># 207 species </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 207</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(traits_chi_sub<span class="sc">$</span>site_code)) <span class="co"># 26 sites</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 26</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">################# exclusion of fence plots  ###########################</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(traits_chi_sub<span class="sc">$</span>trt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "NPK+Fence" "N"         "P"         "K"         "NP"        "NPK"      
 [7] "NK"        "Fence"     "PK"        "Control"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(traits_chi_sub<span class="sc">$</span>fence)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "yes" "no" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">## exclusion of fence treatments </span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>traits_nofence_chi_sub <span class="ot">=</span> <span class="fu">subset</span>(traits_chi_sub, fence <span class="sc">==</span> <span class="st">"no"</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>traits_nofence_chi_sub<span class="sc">$</span>fence</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   [1] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
  [15] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
  [29] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
  [43] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
  [57] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
  [71] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
  [85] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
  [99] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [113] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [127] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [141] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [155] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [169] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [183] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [197] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [211] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [225] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [239] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [253] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [267] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [281] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [295] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [309] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [323] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [337] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [351] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [365] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [379] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [393] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [407] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [421] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [435] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [449] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [463] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [477] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [491] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [505] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [519] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [533] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [547] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [561] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [575] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [589] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [603] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [617] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [631] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [645] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [659] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [673] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [687] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [701] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [715] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [729] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [743] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [757] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [771] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [785] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [799] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [813] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [827] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [841] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [855] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [869] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [883] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [897] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [911] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [925] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [939] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [953] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [967] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [981] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
 [995] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1009] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1023] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1037] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1051] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1065] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1079] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1093] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1107] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1121] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1135] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1149] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1163] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1177] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1191] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1205] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1219] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1233] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1247] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1261] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1275] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1289] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1303] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1317] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1331] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1345] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1359] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1373] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1387] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1401] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1415] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1429] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1443] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1457] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1471] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1485] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1499] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1513] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1527] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1541] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1555] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1569] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1583] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1597] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1611] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1625] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1639] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1653] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1667] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1681] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1695] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1709] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1723] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1737] "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no" "no"
[1751] "no" "no"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(traits_nofence_chi_sub) <span class="do">## 1752</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1752</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(traits_nofence_chi_sub<span class="sc">$</span>Taxon)) <span class="co"># 196 species </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 196</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(traits_chi_sub<span class="sc">$</span>site_code)) <span class="co"># 26 sites</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 26</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(traits_chi_sub<span class="sc">$</span>aridity) <span class="co"># 0.14</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(traits_chi_sub<span class="sc">$</span>aridity) <span class="co"># 2.32</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="do">#########################################</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># packages necessary</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="do">#########################################</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyr' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>loadings</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function (x, ...) 
x$loadings
&lt;bytecode: 0x000001e810abeff0&gt;
&lt;environment: namespace:stats&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dplyr' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyverse' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tibble' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readr' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'purrr' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'stringr' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'forcats' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'lubridate' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats   1.0.0     ✔ readr     2.1.5
✔ ggplot2   3.5.2     ✔ stringr   1.5.1
✔ lubridate 1.9.4     ✔ tibble    3.2.1
✔ purrr     1.0.4     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'lme4' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix

Attaching package: 'Matrix'

The following objects are masked from 'package:tidyr':

    expand, pack, unpack</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'car' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'carData' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'

The following object is masked from 'package:purrr':

    some

The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'emmeans' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome to emmeans.
Caution: You lose important information if you filter this package's results.
See '? untidy'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcompView)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'multcompView' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'nlme'

The following object is masked from 'package:lme4':

    lmList

The following object is masked from 'package:dplyr':

    collapse</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(piecewiseSEM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'piecewiseSEM' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
  This is piecewiseSEM version 2.3.0.1.


  Questions or bugs can be addressed to &lt;jslefche@gmail.com&gt;.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstantools)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'rstantools' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is rstantools version 2.4.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'multcomp' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: mvtnorm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'mvtnorm' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: survival
Loading required package: TH.data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'TH.data' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MASS

Attaching package: 'MASS'

The following object is masked from 'package:dplyr':

    select


Attaching package: 'TH.data'

The following object is masked from 'package:MASS':

    geyser</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(treemapify)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'treemapify' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(relaimpo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'relaimpo' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: boot

Attaching package: 'boot'

The following object is masked from 'package:survival':

    aml

The following object is masked from 'package:car':

    logit

Loading required package: survey</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'survey' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: grid

Attaching package: 'survey'

The following object is masked from 'package:graphics':

    dotchart

Loading required package: mitools</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'mitools' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is the global version of package relaimpo.

If you are a non-US user, a version with the interesting additional metric pmvd is available

from Ulrike Groempings web site at prof.beuth-hochschule.de/groemping.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(r2glmm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'r2glmm' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'patchwork' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'patchwork'

The following object is masked from 'package:MASS':

    area</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggpubr' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 methods overwritten by 'broom':
  method        from 
  nobs.fitdistr MuMIn
  nobs.multinom MuMIn</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'rstatix' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'rstatix'

The following object is masked from 'package:MASS':

    select

The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gridExtra' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'

The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MuMIn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'MuMIn' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'corrr' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggcorrplot' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggcorrplot'

The following object is masked from 'package:rstatix':

    cor_pmat</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'FactoMineR' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'factoextra' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggfortify' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visreg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'visreg' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="do">################################ Statistics #########################################################################</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="do">################################ Statistics #########################################################################</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="do">### function to calculate relative importance for mixed models </span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a><span class="do">### from https://gist.github.com/BERENZ/e9b581a4b7160357934e</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>calc.relip.mm <span class="ot">&lt;-</span> <span class="cf">function</span>(model,<span class="at">type =</span> <span class="st">'lmg'</span>) {</span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">isLMM</span>(model) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">isGLMM</span>(model)) {</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">'Currently supports only lmer/glmer objects'</span>, <span class="at">call. =</span> <span class="cn">FALSE</span>)</span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(lme4)</span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">getME</span>(model,<span class="st">'X'</span>)</span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> X[ , <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">getME</span>(model, <span class="st">'y'</span>)</span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a>  s_resid <span class="ot">&lt;-</span> <span class="fu">sigma</span>(model)</span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a>  s_effect <span class="ot">&lt;-</span> <span class="fu">getME</span>(model, <span class="st">'theta'</span>) <span class="sc">*</span> s_resid</span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a>  s2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(s_resid<span class="sc">^</span><span class="dv">2</span>, s_effect<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a>  V <span class="ot">&lt;-</span> <span class="fu">Diagonal</span>(<span class="at">x =</span> s2, <span class="at">n =</span> <span class="fu">nrow</span>(X))</span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a>  YX <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Y, X)</span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a>  cov_XY <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(YX) <span class="sc">%*%</span> <span class="fu">solve</span>(V) <span class="sc">%*%</span> <span class="fu">as.matrix</span>(YX))</span>
<span id="cb145-23"><a href="#cb145-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(cov_XY) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(cov_XY) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(YX)</span>
<span id="cb145-24"><a href="#cb145-24" aria-hidden="true" tabindex="-1"></a>  importances <span class="ot">&lt;-</span> <span class="fu">calc.relimp</span>(<span class="fu">as.matrix</span>(cov_XY), <span class="at">rela =</span> F, <span class="at">type =</span> type)</span>
<span id="cb145-25"><a href="#cb145-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(importances)</span>
<span id="cb145-26"><a href="#cb145-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb145-27"><a href="#cb145-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-28"><a href="#cb145-28" aria-hidden="true" tabindex="-1"></a>calc.relip.boot.mm <span class="ot">&lt;-</span> <span class="cf">function</span>(model,<span class="at">type =</span> <span class="st">'lmg'</span>) {</span>
<span id="cb145-29"><a href="#cb145-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">isLMM</span>(model) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">isGLMM</span>(model)) {</span>
<span id="cb145-30"><a href="#cb145-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">'Currently supports only lmer/glmer objects'</span>, <span class="at">call. =</span> <span class="cn">FALSE</span>)</span>
<span id="cb145-31"><a href="#cb145-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb145-32"><a href="#cb145-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(lme4)</span>
<span id="cb145-33"><a href="#cb145-33" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">getME</span>(model,<span class="st">'X'</span>)</span>
<span id="cb145-34"><a href="#cb145-34" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> X[ , <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb145-35"><a href="#cb145-35" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">getME</span>(model, <span class="st">'y'</span>)</span>
<span id="cb145-36"><a href="#cb145-36" aria-hidden="true" tabindex="-1"></a>  s_resid <span class="ot">&lt;-</span> <span class="fu">sigma</span>(model)</span>
<span id="cb145-37"><a href="#cb145-37" aria-hidden="true" tabindex="-1"></a>  s_effect <span class="ot">&lt;-</span> <span class="fu">getME</span>(model, <span class="st">'theta'</span>) <span class="sc">*</span> s_resid</span>
<span id="cb145-38"><a href="#cb145-38" aria-hidden="true" tabindex="-1"></a>  s2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(s_resid<span class="sc">^</span><span class="dv">2</span>, s_effect<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb145-39"><a href="#cb145-39" aria-hidden="true" tabindex="-1"></a>  V <span class="ot">&lt;-</span> <span class="fu">Diagonal</span>(<span class="at">x =</span> s2, <span class="at">n =</span> <span class="fu">nrow</span>(X))</span>
<span id="cb145-40"><a href="#cb145-40" aria-hidden="true" tabindex="-1"></a>  YX <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Y, X)</span>
<span id="cb145-41"><a href="#cb145-41" aria-hidden="true" tabindex="-1"></a>  cov_XY <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(YX) <span class="sc">%*%</span> <span class="fu">solve</span>(V) <span class="sc">%*%</span> <span class="fu">as.matrix</span>(YX))</span>
<span id="cb145-42"><a href="#cb145-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(cov_XY) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(cov_XY) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(YX)</span>
<span id="cb145-43"><a href="#cb145-43" aria-hidden="true" tabindex="-1"></a>  bootresults <span class="ot">&lt;-</span> <span class="fu">boot.relimp</span>(<span class="fu">as.matrix</span>(cov_XY), <span class="at">b=</span><span class="dv">1000</span>, <span class="at">rela =</span> F, <span class="at">type =</span> type)</span>
<span id="cb145-44"><a href="#cb145-44" aria-hidden="true" tabindex="-1"></a>  importances <span class="ot">&lt;-</span> <span class="fu">booteval.relimp</span>(bootresults, <span class="at">norank=</span>T)</span>
<span id="cb145-45"><a href="#cb145-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(importances)</span>
<span id="cb145-46"><a href="#cb145-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb145-47"><a href="#cb145-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-48"><a href="#cb145-48" aria-hidden="true" tabindex="-1"></a>multiplot <span class="ot">&lt;-</span> <span class="cf">function</span>(..., <span class="at">plotlist=</span><span class="cn">NULL</span>, cols) {</span>
<span id="cb145-49"><a href="#cb145-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(grid)</span>
<span id="cb145-50"><a href="#cb145-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-51"><a href="#cb145-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make a list from the ... arguments and plotlist</span></span>
<span id="cb145-52"><a href="#cb145-52" aria-hidden="true" tabindex="-1"></a>  plots <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">list</span>(...), plotlist)</span>
<span id="cb145-53"><a href="#cb145-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-54"><a href="#cb145-54" aria-hidden="true" tabindex="-1"></a>  numPlots <span class="ot">=</span> <span class="fu">length</span>(plots)</span>
<span id="cb145-55"><a href="#cb145-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-56"><a href="#cb145-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make the panel</span></span>
<span id="cb145-57"><a href="#cb145-57" aria-hidden="true" tabindex="-1"></a>  plotCols <span class="ot">=</span> cols                          <span class="co"># Number of columns of plots</span></span>
<span id="cb145-58"><a href="#cb145-58" aria-hidden="true" tabindex="-1"></a>  plotRows <span class="ot">=</span> <span class="fu">ceiling</span>(numPlots<span class="sc">/</span>plotCols) <span class="co"># Number of rows needed, calculated from # of cols</span></span>
<span id="cb145-59"><a href="#cb145-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-60"><a href="#cb145-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up the page</span></span>
<span id="cb145-61"><a href="#cb145-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grid.newpage</span>()</span>
<span id="cb145-62"><a href="#cb145-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pushViewport</span>(<span class="fu">viewport</span>(<span class="at">layout =</span> <span class="fu">grid.layout</span>(plotRows, plotCols)))</span>
<span id="cb145-63"><a href="#cb145-63" aria-hidden="true" tabindex="-1"></a>  vplayout <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y)</span>
<span id="cb145-64"><a href="#cb145-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">viewport</span>(<span class="at">layout.pos.row =</span> x, <span class="at">layout.pos.col =</span> y)</span>
<span id="cb145-65"><a href="#cb145-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-66"><a href="#cb145-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make each plot, in the correct location</span></span>
<span id="cb145-67"><a href="#cb145-67" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>numPlots) {</span>
<span id="cb145-68"><a href="#cb145-68" aria-hidden="true" tabindex="-1"></a>    curRow <span class="ot">=</span> <span class="fu">ceiling</span>(i<span class="sc">/</span>plotCols)</span>
<span id="cb145-69"><a href="#cb145-69" aria-hidden="true" tabindex="-1"></a>    curCol <span class="ot">=</span> (i<span class="dv">-1</span>) <span class="sc">%%</span> plotCols <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb145-70"><a href="#cb145-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(plots[[i]], <span class="at">vp =</span> <span class="fu">vplayout</span>(curRow, curCol ))</span>
<span id="cb145-71"><a href="#cb145-71" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb145-72"><a href="#cb145-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-73"><a href="#cb145-73" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb145-74"><a href="#cb145-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-75"><a href="#cb145-75" aria-hidden="true" tabindex="-1"></a><span class="do">############# load data #############################################################################</span></span>
<span id="cb145-76"><a href="#cb145-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-77"><a href="#cb145-77" aria-hidden="true" tabindex="-1"></a>leaf_analysis <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"D:/研究生学习资料/NutNet_Article-1.0.0/NutNet_Article-1.0.0/output/traits_nofence_chi_sub.csv"</span>)</span>
<span id="cb145-78"><a href="#cb145-78" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(leaf_analysis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "X.1"                      "X"                       
  [3] "site_code"                "year"                    
  [5] "block"                    "plot"                    
  [7] "trt"                      "Family"                  
  [9] "Taxon"                    "num_leaves"              
 [11] "leaf_pct_N"               "leaf_pct_C"              
 [13] "leaf_N15_delta_air"       "leaf_C13_delta_PDB"      
 [15] "leaf_N15_pct_atom"        "leaf_C13_pct_atom"       
 [17] "leaf_area_mm2"            "leaf_dry_mass_g"         
 [19] "SLA"                      "leaf_ppm_P"              
 [21] "leaf_ppm_B"               "leaf_ppm_Na"             
 [23] "leaf_ppm_Ca"              "leaf_ppm_Fe"             
 [25] "leaf_ppm_K"               "leaf_ppm_Mg"             
 [27] "leaf_ppm_Mn"              "leaf_ppm_Cu"             
 [29] "leaf_ppm_Zn"              "leaf_ppm_Sr"             
 [31] "leaf_ppm_Pb"              "leaf_ppm_Mo"             
 [33] "SLA_v2"                   "first_nutrient_year"     
 [35] "first_fenced_year"        "year_trt"                
 [37] "soil_pctN"                "soil_ppmP"               
 [39] "Soil_ppmK"                "max_cover"               
 [41] "Ntrt"                     "Ptrt"                    
 [43] "Ktrt"                     "Nfix"                    
 [45] "sum_INT_cover"            "sum_NAT_cover"           
 [47] "sum_UNK_cover"            "total_cover"             
 [49] "INT_rich"                 "NAT_rich"                
 [51] "UNK_rich"                 "rich"                    
 [53] "site_year_rich"           "site_richness"           
 [55] "site_native_richness"     "site_introduced_richness"
 [57] "plot_beta"                "dead_mass"               
 [59] "live_mass"                "total_mass"              
 [61] "unsorted_mass"            "proportion_par"          
 [63] "Ambient_PAR"              "Ground_PAR"              
 [65] "LAI"                      "par_rat"                 
 [67] "site_name"                "continent"               
 [69] "country"                  "region"                  
 [71] "managed"                  "burned"                  
 [73] "grazed"                   "anthropogenic"           
 [75] "habitat"                  "elevation"               
 [77] "latitude"                 "longitude"               
 [79] "experiment_type"          "N"                       
 [81] "P"                        "K"                       
 [83] "Exclose"                  "X.x"                     
 [85] "precip"                   "PET"                     
 [87] "SPEI_12"                  "SPEI_6"                  
 [89] "SPEI_24"                  "SPEI_12.class"           
 [91] "SPEI_6.class"             "SPEI_24.class"           
 [93] "precip.mean"              "PET.mean"                
 [95] "p_pet"                    "tmp"                     
 [97] "par"                      "vpd"                     
 [99] "z"                        "provenance"              
[101] "lifespan"                 "lifeform"                
[103] "functional_group"         "photosynthetic_pathway"  
[105] "n"                        "X.y"                     
[107] "pre2_gs"                  "tmp2_gs"                 
[109] "vpd2_gs"                  "par2_gs"                 
[111] "alpha"                    "subplot"                 
[113] "mass"                     "category"                
[115] "live"                     "pct_C"                   
[117] "pct_N"                    "pct_P"                   
[119] "pct_K"                    "pct_Mg"                  
[121] "pct_Ca"                   "Ntrt_fac"                
[123] "Ptrt_fac"                 "Ktrt_fac"                
[125] "AGN"                      "gs_len"                  
[127] "gs_frac"                  "start_date"              
[129] "end_date"                 "soil.moisture_m3m3_era5" 
[131] "soil_classification"      "classication_source"     
[133] "wilting_point_SR2006"     "field_capacity_SR2006"   
[135] "TEWmax"                   "TEW"                     
[137] "REW"                      "REW_corr"                
[139] "block_fac"                "trt_fac"                 
[141] "sla_m2_g"                 "lma"                     
[143] "narea"                    "nmass"                   
[145] "leaf_pct_P"               "leaf_N_P"                
[147] "leaf_N_C"                 "lai"                     
[149] "par_per_leaf_area"        "spp_live_mass"           
[151] "delta"                    "chi"                     
[153] "fence"                    "loglma"                  
[155] "lognarea"                 "lognmass"                
[157] "log_spp_live_mass"        "aridity"                 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(leaf_analysis<span class="sc">$</span>Taxon)) <span class="co"># 196</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 196</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(leaf_analysis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      X.1               X           site_code              year     
 Min.   :   2.0   Min.   :   2.0   Length:1752        Min.   :2011  
 1st Qu.: 620.8   1st Qu.: 620.8   Class :character   1st Qu.:2011  
 Median :1206.5   Median :1206.5   Mode  :character   Median :2011  
 Mean   :1331.7   Mean   :1331.7                      Mean   :2011  
 3rd Qu.:2224.5   3rd Qu.:2224.5                      3rd Qu.:2011  
 Max.   :2786.0   Max.   :2786.0                      Max.   :2014  
                                                                    
     block           plot           trt               Family         
 Min.   :1.00   Min.   : 1.00   Length:1752        Length:1752       
 1st Qu.:1.00   1st Qu.: 8.00   Class :character   Class :character  
 Median :2.00   Median :15.00   Mode  :character   Mode  :character  
 Mean   :2.04   Mean   :15.76                                        
 3rd Qu.:3.00   3rd Qu.:23.00                                        
 Max.   :4.00   Max.   :41.00                                        
                                                                     
    Taxon             num_leaves      leaf_pct_N       leaf_pct_C   
 Length:1752        Min.   : 0.00   Min.   :0.6576   Min.   :23.57  
 Class :character   1st Qu.: 0.00   1st Qu.:2.0676   1st Qu.:45.54  
 Mode  :character   Median : 5.00   Median :2.8614   Median :46.95  
                    Mean   : 5.16   Mean   :3.0716   Mean   :46.95  
                    3rd Qu.: 5.00   3rd Qu.:3.8603   3rd Qu.:48.31  
                    Max.   :30.00   Max.   :7.8351   Max.   :87.60  
                                    NA's   :1        NA's   :1      
 leaf_N15_delta_air leaf_C13_delta_PDB leaf_N15_pct_atom leaf_C13_pct_atom
 Min.   :-7.1858    Min.   :-32.78     Min.   :0.3549    Min.   :0.364    
 1st Qu.:-1.0417    1st Qu.:-29.40     1st Qu.:0.3659    1st Qu.:1.073    
 Median : 0.1863    Median :-28.30     Median :0.3664    Median :1.074    
 Mean   : 0.8421    Mean   :-27.22     Mean   :0.3665    Mean   :1.022    
 3rd Qu.: 2.0937    3rd Qu.:-27.11     3rd Qu.:0.3670    3rd Qu.:1.076    
 Max.   :20.2732    Max.   :-12.58     Max.   :0.3737    Max.   :1.106    
                                       NA's   :1         NA's   :4        
 leaf_area_mm2      leaf_dry_mass_g         SLA             leaf_ppm_P   
 Min.   :    0.11   Min.   :  0.0004   Min.   :    25.6   Min.   :  403  
 1st Qu.:  231.98   1st Qu.:  0.0260   1st Qu.:  1528.8   1st Qu.: 1501  
 Median :  809.77   Median :  0.0644   Median :  7635.4   Median : 2396  
 Mean   : 1689.54   Mean   :  0.5163   Mean   : 16100.3   Mean   : 2819  
 3rd Qu.: 2046.00   3rd Qu.:  0.1676   3rd Qu.: 20155.6   3rd Qu.: 3741  
 Max.   :41356.99   Max.   :503.1329   Max.   :383274.0   Max.   :11201  
 NA's   :259        NA's   :252        NA's   :20         NA's   :149    
   leaf_ppm_B       leaf_ppm_Na        leaf_ppm_Ca       leaf_ppm_Fe     
 Min.   :  3.935   Min.   :    0.21   Min.   :  634.7   Min.   :  20.31  
 1st Qu.: 16.173   1st Qu.:   16.62   1st Qu.: 4372.4   1st Qu.:  68.23  
 Median : 26.088   Median :   56.58   Median : 9197.1   Median :  90.24  
 Mean   : 48.821   Mean   : 1116.49   Mean   :11545.1   Mean   : 111.70  
 3rd Qu.: 43.255   3rd Qu.:  290.45   3rd Qu.:15271.3   3rd Qu.: 125.96  
 Max.   :815.999   Max.   :81226.79   Max.   :86056.6   Max.   :1519.43  
 NA's   :149       NA's   :152        NA's   :149       NA's   :149      
   leaf_ppm_K        leaf_ppm_Mg     leaf_ppm_Mn        leaf_ppm_Cu     
 Min.   :   786.7   Min.   :  312   Min.   :   8.534   Min.   :  1.399  
 1st Qu.: 13088.5   1st Qu.: 1421   1st Qu.:  58.165   1st Qu.:  4.765  
 Median : 19825.7   Median : 2186   Median : 119.766   Median :  6.542  
 Mean   : 22417.4   Mean   : 2637   Mean   : 257.761   Mean   :  7.618  
 3rd Qu.: 28356.0   3rd Qu.: 3326   3rd Qu.: 258.280   3rd Qu.:  9.151  
 Max.   :112920.4   Max.   :26024   Max.   :8348.390   Max.   :211.070  
 NA's   :149        NA's   :149     NA's   :149        NA's   :150      
  leaf_ppm_Zn       leaf_ppm_Sr        leaf_ppm_Pb        leaf_ppm_Mo     
 Min.   :  2.878   Min.   :  0.9468   Min.   :  0.0200   Min.   : 0.0036  
 1st Qu.: 23.292   1st Qu.: 17.6860   1st Qu.:  0.0885   1st Qu.: 0.1130  
 Median : 36.966   Median : 31.1589   Median :  0.1605   Median : 0.3126  
 Mean   : 51.492   Mean   : 50.5361   Mean   :  1.3678   Mean   : 1.0441  
 3rd Qu.: 63.055   3rd Qu.: 58.1708   3rd Qu.:  0.3275   3rd Qu.: 0.9046  
 Max.   :363.484   Max.   :727.3679   Max.   :603.5456   Max.   :27.8229  
 NA's   :149       NA's   :219        NA's   :149        NA's   :384      
     SLA_v2         first_nutrient_year first_fenced_year    year_trt    
 Min.   :   129.4   Min.   :2008        Min.   :2007      Min.   :0.000  
 1st Qu.:  7800.3   1st Qu.:2008        1st Qu.:2008      1st Qu.:3.000  
 Median : 13292.2   Median :2009        Median :2009      Median :3.000  
 Mean   : 16122.3   Mean   :2009        Mean   :2009      Mean   :3.152  
 3rd Qu.: 19786.4   3rd Qu.:2009        3rd Qu.:2009      3rd Qu.:4.000  
 Max.   :199031.0   Max.   :2013        Max.   :2013      Max.   :4.000  
 NA's   :233        NA's   :217         NA's   :299       NA's   :217    
   soil_pctN       soil_ppmP        Soil_ppmK        max_cover     
 Min.   :0.043   Min.   :  7.00   Min.   :  34.0   Min.   :  0.01  
 1st Qu.:0.128   1st Qu.: 15.25   1st Qu.:  84.0   1st Qu.:  6.00  
 Median :0.365   Median : 35.00   Median : 112.0   Median : 16.00  
 Mean   :0.421   Mean   : 36.57   Mean   : 146.4   Mean   : 23.95  
 3rd Qu.:0.592   3rd Qu.: 52.00   3rd Qu.: 178.0   3rd Qu.: 35.00  
 Max.   :1.553   Max.   :158.00   Max.   :1146.0   Max.   :100.00  
 NA's   :470     NA's   :470      NA's   :470      NA's   :356     
      Ntrt             Ptrt          Ktrt           Nfix          
 Min.   :0.0000   Min.   :0.0   Min.   :0.000   Length:1752       
 1st Qu.:0.0000   1st Qu.:0.0   1st Qu.:0.000   Class :character  
 Median :0.0000   Median :0.5   Median :1.000   Mode  :character  
 Mean   :0.4897   Mean   :0.5   Mean   :0.504                     
 3rd Qu.:1.0000   3rd Qu.:1.0   3rd Qu.:1.000                     
 Max.   :1.0000   Max.   :1.0   Max.   :1.000                     
                                                                  
 sum_INT_cover    sum_NAT_cover    sum_UNK_cover    total_cover   
 Min.   :  0.00   Min.   :  0.00   Min.   : 0.00   Min.   : 21.0  
 1st Qu.:  0.00   1st Qu.: 18.00   1st Qu.: 0.00   1st Qu.: 95.0  
 Median :  5.00   Median : 87.07   Median : 0.00   Median :115.0  
 Mean   : 39.64   Mean   : 85.63   Mean   : 1.58   Mean   :133.5  
 3rd Qu.: 79.00   3rd Qu.:123.00   3rd Qu.: 0.00   3rd Qu.:164.5  
 Max.   :238.00   Max.   :384.00   Max.   :55.00   Max.   :434.0  
 NA's   :179      NA's   :179      NA's   :179     NA's   :179    
    INT_rich         NAT_rich        UNK_rich           rich      
 Min.   : 0.000   Min.   : 0.00   Min.   :0.0000   Min.   : 1.00  
 1st Qu.: 0.000   1st Qu.: 3.00   1st Qu.:0.0000   1st Qu.: 8.00  
 Median : 1.000   Median : 8.00   Median :0.0000   Median :11.00  
 Mean   : 2.839   Mean   :10.21   Mean   :0.2155   Mean   :13.77  
 3rd Qu.: 4.000   3rd Qu.:15.00   3rd Qu.:0.0000   3rd Qu.:19.00  
 Max.   :21.000   Max.   :38.00   Max.   :2.0000   Max.   :38.00  
 NA's   :179      NA's   :179     NA's   :179      NA's   :179    
 site_year_rich  site_richness    site_native_richness site_introduced_richness
 Min.   :13.00   Min.   : 23.00   Min.   :  1.00       Min.   : 0.00           
 1st Qu.:25.00   1st Qu.: 45.00   1st Qu.: 31.00       1st Qu.: 1.00           
 Median :38.00   Median : 67.00   Median : 38.00       Median : 5.00           
 Mean   :42.22   Mean   : 71.86   Mean   : 47.03       Mean   :13.44           
 3rd Qu.:53.00   3rd Qu.:105.00   3rd Qu.: 56.00       3rd Qu.:21.00           
 Max.   :86.00   Max.   :121.00   Max.   :110.00       Max.   :47.00           
 NA's   :179     NA's   :179      NA's   :179          NA's   :179             
   plot_beta        dead_mass         live_mass        total_mass     
 Min.   : 1.818   Min.   :   0.80   Min.   :  10.6   Min.   :  16.55  
 1st Qu.: 3.636   1st Qu.:  35.55   1st Qu.: 189.2   1st Qu.: 237.72  
 Median : 4.824   Median :  83.00   Median : 278.9   Median : 408.23  
 Mean   : 7.136   Mean   : 170.21   Mean   : 401.5   Mean   : 536.62  
 3rd Qu.: 8.500   3rd Qu.: 199.85   3rd Qu.: 501.1   3rd Qu.: 705.40  
 Max.   :58.500   Max.   :1238.00   Max.   :1631.8   Max.   :2126.00  
 NA's   :179      NA's   :505       NA's   :181      NA's   :181      
 unsorted_mass  proportion_par    Ambient_PAR       Ground_PAR    
 Mode:logical   Min.   :0.0088   Min.   : 137.1   Min.   :   8.4  
 NA's:1752      1st Qu.:0.1348   1st Qu.:1564.3   1st Qu.: 188.9  
                Median :0.3361   Median :1740.0   Median : 471.0  
                Mean   :0.3917   Mean   :1634.3   Mean   : 620.0  
                3rd Qu.:0.5884   3rd Qu.:1916.5   3rd Qu.: 953.0  
                Max.   :0.9944   Max.   :2312.0   Max.   :1879.5  
                NA's   :476      NA's   :476      NA's   :476     
      LAI            par_rat        site_name          continent        
 Min.   :0.0113   Min.   :0.0088   Length:1752        Length:1752       
 1st Qu.:1.0606   1st Qu.:0.1348   Class :character   Class :character  
 Median :2.1805   Median :0.3361   Mode  :character   Mode  :character  
 Mean   :2.6031   Mean   :0.3917                                        
 3rd Qu.:4.0080   3rd Qu.:0.5884                                        
 Max.   :9.4730   Max.   :0.9944                                        
 NA's   :476      NA's   :476                                           
   country             region             managed           burned      
 Length:1752        Length:1752        Min.   :0.0000   Min.   :0.0000  
 Class :character   Class :character   1st Qu.:0.0000   1st Qu.:0.0000  
 Mode  :character   Mode  :character   Median :0.0000   Median :0.0000  
                                       Mean   :0.3128   Mean   :0.1005  
                                       3rd Qu.:1.0000   3rd Qu.:0.0000  
                                       Max.   :1.0000   Max.   :1.0000  
                                                                        
     grazed       anthropogenic      habitat            elevation     
 Min.   :0.0000   Min.   :0.0000   Length:1752        Min.   :  50.0  
 1st Qu.:0.0000   1st Qu.:0.0000   Class :character   1st Qu.: 200.0  
 Median :0.0000   Median :0.0000   Mode  :character   Median : 320.0  
 Mean   :0.1433   Mean   :0.1758                      Mean   : 755.9  
 3rd Qu.:0.0000   3rd Qu.:0.0000                      3rd Qu.:1318.1  
 Max.   :1.0000   Max.   :1.0000                      Max.   :2320.0  
                                                                      
    latitude        longitude        experiment_type          N         
 Min.   :-36.87   Min.   :-123.380   Length:1752        Min.   :0.0000  
 1st Qu.: 32.88   1st Qu.:-121.284   Class :character   1st Qu.:0.0000  
 Median : 39.43   Median :  -2.628   Mode  :character   Median :0.0000  
 Mean   : 26.42   Mean   : -21.514                      Mean   :0.4897  
 3rd Qu.: 47.11   3rd Qu.:  11.533                      3rd Qu.:1.0000  
 Max.   : 53.99   Max.   : 151.140                      Max.   :1.0000  
                                                                        
       P             K            Exclose       X.x           precip      
 Min.   :0.0   Min.   :0.000   Min.   :0   Min.   : 451   Min.   : 269.3  
 1st Qu.:0.0   1st Qu.:0.000   1st Qu.:0   1st Qu.:1709   1st Qu.: 642.8  
 Median :0.5   Median :1.000   Median :0   Median :5012   Median :1052.9  
 Mean   :0.5   Mean   :0.504   Mean   :0   Mean   :4539   Mean   :1135.9  
 3rd Qu.:1.0   3rd Qu.:1.000   3rd Qu.:0   3rd Qu.:7407   3rd Qu.:1510.3  
 Max.   :1.0   Max.   :1.000   Max.   :0   Max.   :8661   Max.   :2550.9  
                                           NA's   :179    NA's   :179     
      PET            SPEI_12             SPEI_6            SPEI_24       
 Min.   : 483.9   Min.   :-1.92631   Min.   :-2.15914   Min.   :-2.4032  
 1st Qu.: 690.0   1st Qu.:-1.21872   1st Qu.:-1.22235   1st Qu.:-0.8972  
 Median :1081.4   Median : 0.71909   Median :-0.07539   Median : 0.3598  
 Mean   :1024.7   Mean   : 0.09006   Mean   : 0.04568   Mean   : 0.1571  
 3rd Qu.:1273.1   3rd Qu.: 1.09973   3rd Qu.: 1.41907   3rd Qu.: 1.3231  
 Max.   :1601.8   Max.   : 2.29362   Max.   : 2.17711   Max.   : 1.5796  
 NA's   :179      NA's   :179        NA's   :179        NA's   :179      
 SPEI_12.class       SPEI_6.class      SPEI_24.class      precip.mean    
 Min.   :-2.00000   Min.   :-2.00000   Min.   :-2.0000   Min.   : 288.0  
 1st Qu.:-1.00000   1st Qu.:-1.00000   1st Qu.:-1.0000   1st Qu.: 632.3  
 Median : 1.00000   Median : 0.00000   Median : 0.0000   Median :1010.9  
 Mean   : 0.09536   Mean   : 0.04069   Mean   : 0.3802   Mean   :1085.3  
 3rd Qu.: 1.00000   3rd Qu.: 2.00000   3rd Qu.: 2.0000   3rd Qu.:1188.9  
 Max.   : 2.00000   Max.   : 2.00000   Max.   : 2.0000   Max.   :2216.0  
 NA's   :179        NA's   :179        NA's   :179       NA's   :179     
    PET.mean          p_pet             tmp              par        
 Min.   : 416.8   Min.   :0.1681   Min.   : 3.804   Min.   : 494.9  
 1st Qu.: 739.9   1st Qu.:0.5198   1st Qu.: 9.584   1st Qu.: 635.0  
 Median :1090.4   Median :0.9125   Median :10.599   Median : 829.2  
 Mean   :1022.0   Mean   :1.4575   Mean   :12.271   Mean   : 785.7  
 3rd Qu.:1262.0   3rd Qu.:1.8206   3rd Qu.:15.542   3rd Qu.: 870.8  
 Max.   :1610.0   Max.   :3.9058   Max.   :19.451   Max.   :1009.3  
 NA's   :179      NA's   :179                                       
      vpd               z           provenance          lifespan        
 Min.   :0.1514   Min.   :  61.0   Length:1752        Length:1752       
 1st Qu.:0.3376   1st Qu.: 189.0   Class :character   Class :character  
 Median :0.5433   Median : 365.0   Mode  :character   Mode  :character  
 Mean   :0.5303   Mean   : 653.5                                        
 3rd Qu.:0.6754   3rd Qu.: 854.0                                        
 Max.   :1.0516   Max.   :2254.0                                        
                                                                        
   lifeform         functional_group   photosynthetic_pathway       n         
 Length:1752        Length:1752        Length:1752            Min.   :   2.0  
 Class :character   Class :character   Class :character       1st Qu.: 620.8  
 Mode  :character   Mode  :character   Mode  :character       Median :1206.5  
                                                              Mean   :1331.7  
                                                              3rd Qu.:2224.5  
                                                              Max.   :2786.0  
                                                                              
     X.y               pre2_gs          tmp2_gs          vpd2_gs      
 Length:1752        Min.   : 17.14   Min.   : 4.217   Min.   :0.1581  
 Class :character   1st Qu.: 50.75   1st Qu.:11.100   1st Qu.:0.3764  
 Mode  :character   Median : 60.66   Median :13.334   Median :0.5448  
                    Mean   : 84.51   Mean   :13.241   Mean   :0.5724  
                    3rd Qu.:100.97   3rd Qu.:15.662   3rd Qu.:0.6464  
                    Max.   :194.44   Max.   :20.094   Max.   :1.2755  
                                                                      
    par2_gs           alpha          subplot               mass       
 Min.   : 605.2   Min.   :0.3497   Length:1752        Min.   : 36.70  
 1st Qu.: 750.1   1st Qu.:0.7951   Class :character   1st Qu.: 40.10  
 Median : 792.4   Median :1.0806   Mode  :character   Median : 70.90  
 Mean   : 839.0   Mean   :0.9621                      Mean   : 85.11  
 3rd Qu.: 928.6   3rd Qu.:1.1478                      3rd Qu.:107.50  
 Max.   :1231.1   Max.   :1.2353                      Max.   :189.55  
                                                      NA's   :1238    
   category              live          pct_C           pct_N      
 Length:1752        Min.   :1      Min.   :40.97   Min.   :1.712  
 Class :character   1st Qu.:1      1st Qu.:42.70   1st Qu.:1.712  
 Mode  :character   Median :1      Median :44.38   Median :2.291  
                    Mean   :1      Mean   :43.74   Mean   :2.269  
                    3rd Qu.:1      3rd Qu.:45.42   3rd Qu.:2.770  
                    Max.   :1      Max.   :45.42   Max.   :3.310  
                    NA's   :1238   NA's   :1238    NA's   :1238   
     pct_P            pct_K           pct_Mg           pct_Ca      
 Min.   :0.1644   Min.   :1.783   Min.   :0.1804   Min.   :0.7874  
 1st Qu.:0.3008   1st Qu.:1.835   1st Qu.:0.2094   1st Qu.:0.8840  
 Median :0.3008   Median :1.900   Median :0.2326   Median :1.1072  
 Mean   :0.3047   Mean   :2.477   Mean   :0.2465   Mean   :1.0502  
 3rd Qu.:0.3276   3rd Qu.:2.522   3rd Qu.:0.2816   3rd Qu.:1.1975  
 Max.   :0.4304   Max.   :4.936   Max.   :0.3897   Max.   :1.3100  
 NA's   :1238     NA's   :1238    NA's   :1238     NA's   :1238    
    Ntrt_fac         Ptrt_fac      Ktrt_fac          AGN        
 Min.   :0.0000   Min.   :0.0   Min.   :0.000   Min.   :0.6779  
 1st Qu.:0.0000   1st Qu.:0.0   1st Qu.:0.000   1st Qu.:0.9188  
 Median :0.0000   Median :0.5   Median :1.000   Median :1.2137  
 Mean   :0.4897   Mean   :0.5   Mean   :0.504   Mean   :2.0180  
 3rd Qu.:1.0000   3rd Qu.:1.0   3rd Qu.:1.000   3rd Qu.:3.5583  
 Max.   :1.0000   Max.   :1.0   Max.   :1.000   Max.   :4.6214  
                                                NA's   :1238    
     gs_len         gs_frac        start_date          end_date        
 Min.   :3.000   Min.   :0.2500   Length:1752        Length:1752       
 1st Qu.:5.000   1st Qu.:0.4167   Class :character   Class :character  
 Median :6.000   Median :0.5000   Mode  :character   Mode  :character  
 Mean   :5.936   Mean   :0.4947                                        
 3rd Qu.:8.000   3rd Qu.:0.6667                                        
 Max.   :9.000   Max.   :0.7500                                        
                                                                       
 soil.moisture_m3m3_era5 soil_classification classication_source
 Min.   :0.1651          Length:1752         Length:1752        
 1st Qu.:0.2309          Class :character    Class :character   
 Median :0.3030          Mode  :character    Mode  :character   
 Mean   :0.3163                                                 
 3rd Qu.:0.3698                                                 
 Max.   :0.5629                                                 
                                                                
 wilting_point_SR2006 field_capacity_SR2006     TEWmax           TEW         
 Min.   :0.05000      Min.   :0.1000        Min.   :0.050   Min.   :-0.0154  
 1st Qu.:0.08000      1st Qu.:0.1800        1st Qu.:0.100   1st Qu.: 0.1324  
 Median :0.08000      Median :0.1800        Median :0.100   Median : 0.2200  
 Mean   :0.09916      Mean   :0.2011        Mean   :0.102   Mean   : 0.2189  
 3rd Qu.:0.14000      3rd Qu.:0.2800        3rd Qu.:0.120   3rd Qu.: 0.2898  
 Max.   :0.30000      Max.   :0.4200        Max.   :0.160   Max.   : 0.4829  
 NA's   :80           NA's   :80            NA's   :80      NA's   :80       
      REW              REW_corr        block_fac      trt_fac         
 Min.   :-0.09624   Min.   :0.0000   Min.   :1.00   Length:1752       
 1st Qu.: 1.50863   1st Qu.:1.0000   1st Qu.:1.00   Class :character  
 Median : 2.23000   Median :1.0000   Median :2.00   Mode  :character  
 Mean   : 2.31684   Mean   :0.9383   Mean   :2.04                     
 3rd Qu.: 2.89789   3rd Qu.:1.0000   3rd Qu.:3.00                     
 Max.   : 4.82863   Max.   :1.0000   Max.   :4.00                     
 NA's   :80         NA's   :80                                        
    sla_m2_g            lma               narea               nmass       
 Min.   :0.00013   Min.   :   5.024   Min.   :  0.08456   Min.   :0.6576  
 1st Qu.:0.00780   1st Qu.:  50.540   1st Qu.:  1.41002   1st Qu.:2.0676  
 Median :0.01329   Median :  75.232   Median :  2.19632   Median :2.8614  
 Mean   :0.01612   Mean   : 186.824   Mean   :  4.89398   Mean   :3.0716  
 3rd Qu.:0.01979   3rd Qu.: 128.202   3rd Qu.:  3.57829   3rd Qu.:3.8603  
 Max.   :0.19903   Max.   :7728.571   Max.   :194.87702   Max.   :7.8351  
 NA's   :233       NA's   :233        NA's   :234         NA's   :1       
   leaf_pct_P        leaf_N_P         leaf_N_C           lai        
 Min.   :0.0403   Min.   : 1.918   Min.   : 6.032   Min.   :0.0066  
 1st Qu.:0.1501   1st Qu.: 7.834   1st Qu.:11.903   1st Qu.:0.6166  
 Median :0.2396   Median :12.130   Median :16.261   Median :1.2677  
 Mean   :0.2819   Mean   :14.201   Mean   :18.679   Mean   :1.5134  
 3rd Qu.:0.3741   3rd Qu.:18.070   3rd Qu.:22.573   3rd Qu.:2.3302  
 Max.   :1.1201   Max.   :74.458   Max.   :71.062   Max.   :5.5075  
 NA's   :149      NA's   :149      NA's   :1        NA's   :476     
 par_per_leaf_area spp_live_mass           delta             chi        
 Min.   :150.5     Min.   :   0.0408   Min.   : 4.636   Min.   :0.1241  
 1st Qu.:230.2     1st Qu.:  15.2034   1st Qu.:19.647   1st Qu.:0.6833  
 Median :290.5     Median :  43.1174   Median :20.890   Median :0.7345  
 Mean   :317.6     Mean   : 104.9624   Mean   :19.776   Mean   :0.7264  
 3rd Qu.:371.6     3rd Qu.: 113.0597   3rd Qu.:22.044   3rd Qu.:0.7839  
 Max.   :600.5     Max.   :1462.9060   Max.   :25.620   Max.   :0.9390  
 NA's   :476       NA's   :358                                          
    fence               loglma         lognarea          lognmass      
 Length:1752        Min.   :1.614   Min.   :-2.4702   Min.   :-0.4192  
 Class :character   1st Qu.:3.923   1st Qu.: 0.3436   1st Qu.: 0.7264  
 Mode  :character   Median :4.321   Median : 0.7868   Median : 1.0513  
                    Mean   :4.518   Mean   : 0.9029   Mean   : 1.0251  
                    3rd Qu.:4.854   3rd Qu.: 1.2749   3rd Qu.: 1.3507  
                    Max.   :8.953   Max.   : 5.2724   Max.   : 2.0586  
                    NA's   :233     NA's   :234       NA's   :1        
 log_spp_live_mass    aridity      
 Min.   :-3.199    Min.   :0.1681  
 1st Qu.: 2.721    1st Qu.:0.5198  
 Median : 3.764    Median :0.9125  
 Mean   : 3.615    Mean   :1.4575  
 3rd Qu.: 4.728    3rd Qu.:1.8206  
 Max.   : 7.288    Max.   :3.9058  
 NA's   :358       NA's   :179     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="do">################### make table summarizing climate data for each site (table S1)</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>selected_data <span class="ot">&lt;-</span> leaf_analysis <span class="sc">%&gt;%</span> </span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(site_code, latitude, longitude, tmp, aridity, par2_gs, first_nutrient_year)</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>calculate_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="fu">is.numeric</span>(x)) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="cf">else</span> <span class="fu">first</span>(x)</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> selected_data <span class="sc">%&gt;%</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(site_code) <span class="sc">%&gt;%</span></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(calculate_mean)</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a><span class="do">######################## linear mixed effects model for Nmass #######################################</span></span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a><span class="do">#####################################################################################################</span></span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Hypothesis: Nmass increases with N and P addition, increases with aridity and cold tmp</span></span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a><span class="do">########## Nmass is higher in N-fixing species and C3 species #############</span></span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-17"><a href="#cb151-17" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(leaf_analysis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "X.1"                      "X"                       
  [3] "site_code"                "year"                    
  [5] "block"                    "plot"                    
  [7] "trt"                      "Family"                  
  [9] "Taxon"                    "num_leaves"              
 [11] "leaf_pct_N"               "leaf_pct_C"              
 [13] "leaf_N15_delta_air"       "leaf_C13_delta_PDB"      
 [15] "leaf_N15_pct_atom"        "leaf_C13_pct_atom"       
 [17] "leaf_area_mm2"            "leaf_dry_mass_g"         
 [19] "SLA"                      "leaf_ppm_P"              
 [21] "leaf_ppm_B"               "leaf_ppm_Na"             
 [23] "leaf_ppm_Ca"              "leaf_ppm_Fe"             
 [25] "leaf_ppm_K"               "leaf_ppm_Mg"             
 [27] "leaf_ppm_Mn"              "leaf_ppm_Cu"             
 [29] "leaf_ppm_Zn"              "leaf_ppm_Sr"             
 [31] "leaf_ppm_Pb"              "leaf_ppm_Mo"             
 [33] "SLA_v2"                   "first_nutrient_year"     
 [35] "first_fenced_year"        "year_trt"                
 [37] "soil_pctN"                "soil_ppmP"               
 [39] "Soil_ppmK"                "max_cover"               
 [41] "Ntrt"                     "Ptrt"                    
 [43] "Ktrt"                     "Nfix"                    
 [45] "sum_INT_cover"            "sum_NAT_cover"           
 [47] "sum_UNK_cover"            "total_cover"             
 [49] "INT_rich"                 "NAT_rich"                
 [51] "UNK_rich"                 "rich"                    
 [53] "site_year_rich"           "site_richness"           
 [55] "site_native_richness"     "site_introduced_richness"
 [57] "plot_beta"                "dead_mass"               
 [59] "live_mass"                "total_mass"              
 [61] "unsorted_mass"            "proportion_par"          
 [63] "Ambient_PAR"              "Ground_PAR"              
 [65] "LAI"                      "par_rat"                 
 [67] "site_name"                "continent"               
 [69] "country"                  "region"                  
 [71] "managed"                  "burned"                  
 [73] "grazed"                   "anthropogenic"           
 [75] "habitat"                  "elevation"               
 [77] "latitude"                 "longitude"               
 [79] "experiment_type"          "N"                       
 [81] "P"                        "K"                       
 [83] "Exclose"                  "X.x"                     
 [85] "precip"                   "PET"                     
 [87] "SPEI_12"                  "SPEI_6"                  
 [89] "SPEI_24"                  "SPEI_12.class"           
 [91] "SPEI_6.class"             "SPEI_24.class"           
 [93] "precip.mean"              "PET.mean"                
 [95] "p_pet"                    "tmp"                     
 [97] "par"                      "vpd"                     
 [99] "z"                        "provenance"              
[101] "lifespan"                 "lifeform"                
[103] "functional_group"         "photosynthetic_pathway"  
[105] "n"                        "X.y"                     
[107] "pre2_gs"                  "tmp2_gs"                 
[109] "vpd2_gs"                  "par2_gs"                 
[111] "alpha"                    "subplot"                 
[113] "mass"                     "category"                
[115] "live"                     "pct_C"                   
[117] "pct_N"                    "pct_P"                   
[119] "pct_K"                    "pct_Mg"                  
[121] "pct_Ca"                   "Ntrt_fac"                
[123] "Ptrt_fac"                 "Ktrt_fac"                
[125] "AGN"                      "gs_len"                  
[127] "gs_frac"                  "start_date"              
[129] "end_date"                 "soil.moisture_m3m3_era5" 
[131] "soil_classification"      "classication_source"     
[133] "wilting_point_SR2006"     "field_capacity_SR2006"   
[135] "TEWmax"                   "TEW"                     
[137] "REW"                      "REW_corr"                
[139] "block_fac"                "trt_fac"                 
[141] "sla_m2_g"                 "lma"                     
[143] "narea"                    "nmass"                   
[145] "leaf_pct_P"               "leaf_N_P"                
[147] "leaf_N_C"                 "lai"                     
[149] "par_per_leaf_area"        "spp_live_mass"           
[151] "delta"                    "chi"                     
[153] "fence"                    "loglma"                  
[155] "lognarea"                 "lognmass"                
[157] "log_spp_live_mass"        "aridity"                 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(leaf_analysis<span class="sc">$</span>lognmass) <span class="co"># normal distribution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>leafNmass_lmer <span class="ot">&lt;-</span> <span class="fu">lmer</span>(lognmass<span class="sc">~</span> Ntrt_fac <span class="sc">*</span> Ptrt_fac <span class="sc">*</span> Ktrt_fac <span class="sc">+</span> tmp <span class="sc">+</span> </span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>                         par2_gs <span class="sc">+</span> loglma <span class="sc">+</span> chi <span class="sc">+</span> Nfix <span class="sc">+</span> photosynthetic_pathway <span class="sc">+</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">|</span>Taxon) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Taxon<span class="sc">:</span>site_code) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Taxon<span class="sc">:</span>site_code<span class="sc">:</span>block_fac), </span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> leaf_analysis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Some predictor variables are on very different scales: consider
rescaling</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">resid</span>(leafNmass_lmer) <span class="sc">~</span> <span class="fu">fitted</span>(leafNmass_lmer))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(leafNmass_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: lognmass ~ Ntrt_fac * Ptrt_fac * Ktrt_fac + tmp + par2_gs + loglma +  
    chi + Nfix + photosynthetic_pathway + (1 | Taxon) + (1 |  
    Taxon:site_code) + (1 | Taxon:site_code:block_fac)
   Data: leaf_analysis

REML criterion at convergence: 199.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.6743 -0.5327  0.0282  0.5376  3.5023 

Random effects:
 Groups                    Name        Variance Std.Dev.
 Taxon:site_code:block_fac (Intercept) 0.01251  0.1118  
 Taxon:site_code           (Intercept) 0.07550  0.2748  
 Taxon                     (Intercept) 0.00000  0.0000  
 Residual                              0.04115  0.2029  
Number of obs: 1518, groups:  
Taxon:site_code:block_fac, 445; Taxon:site_code, 233; Taxon, 186

Fixed effects:
                             Estimate Std. Error t value
(Intercept)                 1.2843375  0.1746818   7.352
Ntrt_fac                    0.2074462  0.0225771   9.188
Ptrt_fac                    0.0341752  0.0220954   1.547
Ktrt_fac                    0.0037938  0.0222900   0.170
tmp                        -0.0262867  0.0059359  -4.428
par2_gs                     0.0003999  0.0001341   2.982
loglma                     -0.0554273  0.0111941  -4.951
chi                        -0.2433157  0.1139732  -2.135
Nfixyes                     0.4837340  0.0657074   7.362
photosynthetic_pathwayC4   -0.5724616  0.0855574  -6.691
Ntrt_fac:Ptrt_fac          -0.0616127  0.0315520  -1.953
Ntrt_fac:Ktrt_fac           0.0002368  0.0314950   0.008
Ptrt_fac:Ktrt_fac           0.0115212  0.0312845   0.368
Ntrt_fac:Ptrt_fac:Ktrt_fac -0.0262289  0.0444650  -0.590</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Correlation matrix not shown by default, as p = 14 &gt; 12.
Use print(x, correlation=TRUE)  or
    vcov(x)        if you need it</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>fit warnings:
Some predictor variables are on very different scales: consider rescaling
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(leafNmass_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II Wald chisquare tests)

Response: lognmass
                              Chisq Df Pr(&gt;Chisq)    
Ntrt_fac                   225.2272  1  &lt; 2.2e-16 ***
Ptrt_fac                     0.0582  1  0.8092926    
Ktrt_fac                     0.0847  1  0.7709746    
tmp                         19.6112  1  9.491e-06 ***
par2_gs                      8.8907  1  0.0028662 ** 
loglma                      24.5171  1  7.365e-07 ***
chi                          4.5576  1  0.0327732 *  
Nfix                        54.1981  1  1.813e-13 ***
photosynthetic_pathway      44.7690  1  2.217e-11 ***
Ntrt_fac:Ptrt_fac           11.4504  1  0.0007148 ***
Ntrt_fac:Ktrt_fac            0.3344  1  0.5630527    
Ptrt_fac:Ktrt_fac            0.0045  1  0.9462304    
Ntrt_fac:Ptrt_fac:Ktrt_fac   0.3480  1  0.5552731    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(leafNmass_lmer) <span class="co"># 235.448</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 235.4489</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(leafNmass_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Ntrt_fac                   Ptrt_fac 
                  4.028517                   3.929380 
                  Ktrt_fac                        tmp 
                  3.965085                   1.152850 
                   par2_gs                     loglma 
                  1.021652                   1.026431 
                       chi                       Nfix 
                  1.129423                   1.020303 
    photosynthetic_pathway          Ntrt_fac:Ptrt_fac 
                  1.262423                   5.918243 
         Ntrt_fac:Ktrt_fac          Ptrt_fac:Ktrt_fac 
                  5.937819                   5.936071 
Ntrt_fac:Ptrt_fac:Ktrt_fac 
                  6.848896 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(leafNmass_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(leafNmass_lmer))</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(leafNmass_lmer))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">densityPlot</span>(<span class="fu">residuals</span>(leafNmass_lmer))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(leafNmass_lmer)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(leafNmass_lmer)
W = 0.9922, p-value = 3.366e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">outlierTest</span>(leafNmass_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>No Studentized residuals with Bonferroni p &lt; 0.05
Largest |rstudent|:
    rstudent unadjusted p-value Bonferroni p
699 4.138513           3.69e-05     0.056015</code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> <span class="fu">resid</span>(leafNmass_lmer)</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(residuals, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">"Histogram of Residuals"</span>) <span class="do">## good</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(leafNmass_lmer), residuals, <span class="at">xlab =</span> <span class="st">"Fitted Values"</span>, <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Residuals vs. Fitted Values"</span>)  <span class="co"># heteroscedasticity : none </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r.squaredGLMM</span>(leafNmass_lmer) <span class="do">## R2 mariginal: 0.46, R2 conditional : 0.83</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in Taxon:site_code:block_fac: numerical expression has 1518 elements:
only the first used</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>          R2m      R2c
[1,] 0.458254 0.827393</code></pre>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="do">######### Export Nmass model ####################################</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>Nmass_model <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Var =</span> <span class="fu">c</span>(<span class="st">'Soil N'</span>, <span class="st">'Soil P'</span>, <span class="st">'Soil K+µ'</span>, <span class="st">'Tg'</span>, </span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'PAR'</span>, <span class="st">'ln LMA'</span>, <span class="st">'χ'</span>, <span class="st">'N fixer'</span>, <span class="st">'C3/C4'</span>,</span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'Soil N x Soil P'</span>, <span class="st">'Soil N x Soil K'</span>, <span class="st">'Soil P x Soil K'</span>,</span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'Soil N x Soil P x Soil K'</span>))</span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>Nmass_model<span class="sc">$</span>df <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">Anova</span>(leafNmass_lmer))[<span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>, <span class="dv">2</span>]</span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a>Nmass_model<span class="sc">$</span>Slope <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,</span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">summary</span>(<span class="fu">emtrends</span>(leafNmass_lmer, <span class="sc">~</span>tmp, <span class="at">var =</span> <span class="st">"tmp"</span>))[<span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">summary</span>(<span class="fu">emtrends</span>(leafNmass_lmer, <span class="sc">~</span>par2_gs, <span class="at">var =</span> <span class="st">"par2_gs"</span>))[<span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">summary</span>(<span class="fu">emtrends</span>(leafNmass_lmer, <span class="sc">~</span>loglma, <span class="at">var =</span> <span class="st">"loglma"</span>))[<span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">summary</span>(<span class="fu">emtrends</span>(leafNmass_lmer, <span class="sc">~</span>chi, <span class="at">var =</span> <span class="st">"chi"</span>))[<span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb180-13"><a href="#cb180-13" aria-hidden="true" tabindex="-1"></a>                       <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb180-14"><a href="#cb180-14" aria-hidden="true" tabindex="-1"></a>Nmass_model<span class="sc">$</span>SE <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,</span>
<span id="cb180-15"><a href="#cb180-15" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">summary</span>(<span class="fu">emtrends</span>(leafNmass_lmer, <span class="sc">~</span>tmp, <span class="at">var =</span> <span class="st">"tmp"</span>))[<span class="dv">1</span>, <span class="dv">3</span>],</span>
<span id="cb180-16"><a href="#cb180-16" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">summary</span>(<span class="fu">emtrends</span>(leafNmass_lmer, <span class="sc">~</span>par2_gs, <span class="at">var =</span> <span class="st">"par2_gs"</span>))[<span class="dv">1</span>, <span class="dv">3</span>],</span>
<span id="cb180-17"><a href="#cb180-17" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">summary</span>(<span class="fu">emtrends</span>(leafNmass_lmer, <span class="sc">~</span>loglma, <span class="at">var =</span> <span class="st">"loglma"</span>))[<span class="dv">1</span>, <span class="dv">3</span>],</span>
<span id="cb180-18"><a href="#cb180-18" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">summary</span>(<span class="fu">emtrends</span>(leafNmass_lmer, <span class="sc">~</span>chi, <span class="at">var =</span> <span class="st">"chi"</span>))[<span class="dv">1</span>, <span class="dv">3</span>],</span>
<span id="cb180-19"><a href="#cb180-19" aria-hidden="true" tabindex="-1"></a>                    <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb180-20"><a href="#cb180-20" aria-hidden="true" tabindex="-1"></a>Nmass_model<span class="sc">$</span>p <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">Anova</span>(leafNmass_lmer))[<span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>, <span class="dv">3</span>]</span>
<span id="cb180-21"><a href="#cb180-21" aria-hidden="true" tabindex="-1"></a>Nmass_model<span class="sc">$</span>RelImp <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">calc.relip.mm</span>(leafNmass_lmer)<span class="sc">$</span>lmg)[<span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>]</span>
<span id="cb180-22"><a href="#cb180-22" aria-hidden="true" tabindex="-1"></a>Nmass_model<span class="sc">$</span>RelImp <span class="ot">&lt;-</span> Nmass_model<span class="sc">$</span>RelImp <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb180-23"><a href="#cb180-23" aria-hidden="true" tabindex="-1"></a>Nmass_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Var df         Slope           SE            p
1                    Soil N  1            NA           NA 6.550193e-51
2                    Soil P  1            NA           NA 8.092926e-01
3                  Soil K+µ  1            NA           NA 7.709746e-01
4                        Tg  1 -0.0262867434 0.0059909594 9.491282e-06
5                       PAR  1  0.0003998939 0.0001352872 2.866204e-03
6                    ln LMA  1 -0.0554272992 0.0112452917 7.365294e-07
7                         χ  1 -0.2433156658 0.1144335476 3.277321e-02
8                   N fixer  1            NA           NA 1.812630e-13
9                     C3/C4  1            NA           NA 2.217041e-11
10          Soil N x Soil P  1            NA           NA 7.147951e-04
11          Soil N x Soil K  1            NA           NA 5.630527e-01
12          Soil P x Soil K  1            NA           NA 9.462304e-01
13 Soil N x Soil P x Soil K  1            NA           NA 5.552731e-01
       RelImp
1   5.2986303
2   2.0122955
3   1.7031194
4   8.7387355
5  18.2182605
6   9.0385467
7  25.1827959
8   9.6176509
9   6.5002414
10  1.0019101
11  0.9517314
12  0.5294481
13  0.3729046</code></pre>
</div>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### soil nitrogen effect for the tables in supplementary information </span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="co"># percentage increase of Nmass in plots receiving N compared to plots not receiving N</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>(<span class="fu">summary</span>(<span class="fu">emmeans</span>(leafNmass_lmer, <span class="sc">~</span>Ntrt_fac))[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">summary</span>(<span class="fu">emmeans</span>(leafNmass_lmer, <span class="sc">~</span>Ntrt_fac))[<span class="dv">1</span>,<span class="dv">2</span>])<span class="sc">/</span></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="fu">emmeans</span>(leafNmass_lmer, <span class="sc">~</span>Ntrt_fac))[<span class="dv">1</span>,<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: Results may be misleading due to involvement in interactions
NOTE: Results may be misleading due to involvement in interactions
NOTE: Results may be misleading due to involvement in interactions</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.201442</code></pre>
</div>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.201442</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="co"># percentage increase of Nmass in plots receiving N but not P compared to plots not receiving N or P</span></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>(<span class="fu">summary</span>(<span class="fu">emmeans</span>(leafNmass_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac))[<span class="dv">2</span>,<span class="dv">3</span>] <span class="sc">-</span> <span class="fu">summary</span>(<span class="fu">emmeans</span>(leafNmass_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac))[<span class="dv">1</span>,<span class="dv">3</span>])<span class="sc">/</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="fu">emmeans</span>(leafNmass_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac))[<span class="dv">1</span>,<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: Results may be misleading due to involvement in interactions
NOTE: Results may be misleading due to involvement in interactions
NOTE: Results may be misleading due to involvement in interactions</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2516101</code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.2516</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="co"># percentage increase of Nmass in N fixers compared to non-N fixers</span></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>(<span class="fu">summary</span>(<span class="fu">emmeans</span>(leafNmass_lmer, <span class="sc">~</span>Nfix))[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">summary</span>(<span class="fu">emmeans</span>(leafNmass_lmer, <span class="sc">~</span>Nfix))[<span class="dv">1</span>,<span class="dv">2</span>])<span class="sc">/</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="fu">emmeans</span>(leafNmass_lmer, <span class="sc">~</span>Nfix))[<span class="dv">1</span>,<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7029515</code></pre>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.7029515</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="co"># percentage increase of Nmass in C3s compared to C4s</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>(<span class="fu">summary</span>(<span class="fu">emmeans</span>(leafNmass_lmer, <span class="sc">~</span>photosynthetic_pathway))[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">summary</span>(<span class="fu">emmeans</span>(leafNmass_lmer, <span class="sc">~</span>photosynthetic_pathway))[<span class="dv">2</span>,<span class="dv">2</span>])<span class="sc">/</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="fu">emmeans</span>(leafNmass_lmer, <span class="sc">~</span>photosynthetic_pathway))[<span class="dv">2</span>,<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.889215</code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.889215</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>leaf_analysis<span class="sc">$</span>PKgroup[leaf_analysis<span class="sc">$</span>Ptrt_fac <span class="sc">==</span> <span class="st">'0'</span> <span class="sc">&amp;</span> leaf_analysis<span class="sc">$</span>Ktrt_fac <span class="sc">==</span> <span class="st">'0'</span>] <span class="ot">&lt;-</span> <span class="st">'-P, -K+µ'</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>leaf_analysis<span class="sc">$</span>PKgroup[leaf_analysis<span class="sc">$</span>Ptrt_fac <span class="sc">==</span> <span class="st">'1'</span> <span class="sc">&amp;</span> leaf_analysis<span class="sc">$</span>Ktrt_fac <span class="sc">==</span> <span class="st">'0'</span>] <span class="ot">&lt;-</span> <span class="st">'+P, -K+µ'</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>leaf_analysis<span class="sc">$</span>PKgroup[leaf_analysis<span class="sc">$</span>Ptrt_fac <span class="sc">==</span> <span class="st">'0'</span> <span class="sc">&amp;</span> leaf_analysis<span class="sc">$</span>Ktrt_fac <span class="sc">==</span> <span class="st">'1'</span>] <span class="ot">&lt;-</span> <span class="st">'-P, +K+µ'</span></span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>leaf_analysis<span class="sc">$</span>PKgroup[leaf_analysis<span class="sc">$</span>Ptrt_fac <span class="sc">==</span> <span class="st">'1'</span> <span class="sc">&amp;</span> leaf_analysis<span class="sc">$</span>Ktrt_fac <span class="sc">==</span> <span class="st">'1'</span>] <span class="ot">&lt;-</span> <span class="st">'+P, +K+µ'</span></span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a>cld_test <span class="ot">&lt;-</span> <span class="fu">cld</span>(<span class="fu">emmeans</span>(leafNmass_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac <span class="sc">*</span> Ktrt_fac)) </span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a><span class="do">## comp slopes : plots receiving N higher than those which did not </span></span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a>cld_test<span class="sc">$</span>.group</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] " 1 " " 1 " " 1 " " 1 " "  2" "  2" "  2" "  2"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>leafnmass_letters <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">1.2</span>, <span class="fl">1.8</span>, <span class="fl">2.2</span>, <span class="fl">2.8</span>, <span class="fl">3.2</span>, <span class="fl">3.8</span>, <span class="fl">4.2</span>),</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">NPgroup =</span> <span class="fu">c</span>(<span class="st">'-P, -K+µ'</span>, <span class="st">'-P, -K+µ'</span>, <span class="st">'+P, -K+µ'</span>, <span class="st">'+P, -K+µ'</span>, </span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">'-P, +K+µ'</span>, <span class="st">'-P, +K+µ'</span>, <span class="st">'+P, +K+µ'</span>, <span class="st">'+P, +K+µ'</span>),</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">Ntrt_fac =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">2.7</span>, <span class="fl">2.7</span>, <span class="fl">2.7</span>, <span class="fl">2.7</span>, <span class="fl">2.7</span>, <span class="fl">2.7</span>, <span class="fl">2.8</span>, <span class="fl">2.8</span>), </span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>                                <span class="at">group =</span> <span class="fu">c</span>(<span class="fu">cld</span>(<span class="fu">emmeans</span>(leafNmass_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac <span class="sc">*</span> Ktrt_fac))[<span class="dv">1</span>, <span class="dv">9</span>],</span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">cld</span>(<span class="fu">emmeans</span>(leafNmass_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac <span class="sc">*</span> Ktrt_fac))[<span class="dv">7</span>, <span class="dv">9</span>],</span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">cld</span>(<span class="fu">emmeans</span>(leafNmass_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac <span class="sc">*</span> Ktrt_fac))[<span class="dv">3</span>, <span class="dv">9</span>],</span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">cld</span>(<span class="fu">emmeans</span>(leafNmass_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac <span class="sc">*</span> Ktrt_fac))[<span class="dv">6</span>, <span class="dv">9</span>],</span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">cld</span>(<span class="fu">emmeans</span>(leafNmass_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac <span class="sc">*</span> Ktrt_fac))[<span class="dv">2</span>, <span class="dv">9</span>],</span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">cld</span>(<span class="fu">emmeans</span>(leafNmass_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac <span class="sc">*</span> Ktrt_fac))[<span class="dv">8</span>, <span class="dv">9</span>],</span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">cld</span>(<span class="fu">emmeans</span>(leafNmass_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac <span class="sc">*</span> Ktrt_fac))[<span class="dv">4</span>, <span class="dv">9</span>],</span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">cld</span>(<span class="fu">emmeans</span>(leafNmass_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac <span class="sc">*</span> Ktrt_fac))[<span class="dv">5</span>, <span class="dv">9</span>]))</span>
<span id="cb194-14"><a href="#cb194-14" aria-hidden="true" tabindex="-1"></a>leafnmass_letters<span class="sc">$</span>Ntrt_fac <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(leafnmass_letters<span class="sc">$</span>Ntrt_fac)</span>
<span id="cb194-15"><a href="#cb194-15" aria-hidden="true" tabindex="-1"></a>leafnmass_letters<span class="sc">$</span>letter[leafnmass_letters<span class="sc">$</span>group <span class="sc">==</span> <span class="st">" 1 "</span>] <span class="ot">&lt;-</span> <span class="st">"a"</span></span>
<span id="cb194-16"><a href="#cb194-16" aria-hidden="true" tabindex="-1"></a>leafnmass_letters<span class="sc">$</span>letter[leafnmass_letters<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"  2"</span>] <span class="ot">&lt;-</span> <span class="st">"b"</span></span>
<span id="cb194-17"><a href="#cb194-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-18"><a href="#cb194-18" aria-hidden="true" tabindex="-1"></a><span class="do">#### Regression table emmeans + SE </span></span>
<span id="cb194-19"><a href="#cb194-19" aria-hidden="true" tabindex="-1"></a>se_table <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">emmeans</span>(leafNmass_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ktrt_fac <span class="sc">*</span> Ptrt_fac))</span>
<span id="cb194-20"><a href="#cb194-20" aria-hidden="true" tabindex="-1"></a>se_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Ntrt_fac Ktrt_fac Ptrt_fac emmean     SE  df lower.CL upper.CL
        0        0        0  0.823 0.0529 218    0.719    0.927
        1        0        0  1.030 0.0539 234    0.924    1.137
        0        1        0  0.827 0.0529 221    0.723    0.931
        1        1        0  1.035 0.0532 226    0.930    1.139
        0        0        1  0.857 0.0531 224    0.753    0.962
        1        0        1  1.003 0.0536 229    0.897    1.109
        0        1        1  0.873 0.0525 215    0.769    0.976
        1        1        1  0.992 0.0535 229    0.887    1.098

Results are averaged over the levels of: Nfix, photosynthetic_pathway 
Degrees-of-freedom method: kenward-roger 
Confidence level used: 0.95 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>se_table <span class="ot">=</span> <span class="fu">as.data.frame</span>(se_table)</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>se_table<span class="sc">$</span>PKgroup[se_table<span class="sc">$</span>Ptrt_fac <span class="sc">==</span> <span class="st">'0'</span> <span class="sc">&amp;</span> se_table<span class="sc">$</span>Ktrt_fac <span class="sc">==</span> <span class="st">'0'</span>] <span class="ot">&lt;-</span> <span class="st">'-P, -K+µ'</span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>se_table<span class="sc">$</span>PKgroup[se_table<span class="sc">$</span>Ptrt_fac <span class="sc">==</span> <span class="st">'1'</span> <span class="sc">&amp;</span> se_table<span class="sc">$</span>Ktrt_fac <span class="sc">==</span> <span class="st">'0'</span>] <span class="ot">&lt;-</span> <span class="st">'+P, -K+µ'</span></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>se_table<span class="sc">$</span>PKgroup[se_table<span class="sc">$</span>Ptrt_fac <span class="sc">==</span> <span class="st">'0'</span> <span class="sc">&amp;</span> se_table<span class="sc">$</span>Ktrt_fac <span class="sc">==</span> <span class="st">'1'</span>] <span class="ot">&lt;-</span> <span class="st">'-P, +K+µ'</span></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>se_table<span class="sc">$</span>PKgroup[se_table<span class="sc">$</span>Ptrt_fac <span class="sc">==</span> <span class="st">'1'</span> <span class="sc">&amp;</span> se_table<span class="sc">$</span>Ktrt_fac <span class="sc">==</span> <span class="st">'1'</span>] <span class="ot">&lt;-</span> <span class="st">'+P, +K+µ'</span></span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(se_table)[<span class="fu">which</span>(<span class="fu">names</span>(se_table) <span class="sc">==</span> <span class="st">"emmean"</span>)] <span class="ot">&lt;-</span> <span class="st">"lognmass"</span></span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a><span class="do">################ Nmass violin plot + emmean and SE ################################################</span></span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a>leaf_analysis<span class="sc">$</span>Ntrt_fac <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(leaf_analysis<span class="sc">$</span>Ntrt_fac)</span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a>se_table<span class="sc">$</span>Ntrt_fac <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(se_table<span class="sc">$</span>Ntrt_fac)</span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true" tabindex="-1"></a>nmass_violin <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> leaf_analysis, </span>
<span id="cb196-15"><a href="#cb196-15" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x =</span> PKgroup, <span class="at">y =</span> lognmass, <span class="at">fill =</span> Ntrt_fac),<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>), <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb196-16"><a href="#cb196-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb196-17"><a href="#cb196-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> se_table, <span class="fu">aes</span>(<span class="at">x =</span> PKgroup, <span class="at">y =</span> lognmass, <span class="at">fill =</span> Ntrt_fac), </span>
<span id="cb196-18"><a href="#cb196-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb196-19"><a href="#cb196-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-20"><a href="#cb196-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data =</span> se_table, <span class="fu">aes</span>(<span class="at">x =</span> PKgroup, <span class="at">y =</span> lognmass, <span class="at">ymin =</span> lognmass <span class="sc">-</span> SE, <span class="at">ymax =</span> lognmass <span class="sc">+</span> SE, </span>
<span id="cb196-21"><a href="#cb196-21" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">fill =</span> Ntrt_fac), <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb196-22"><a href="#cb196-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-23"><a href="#cb196-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> leafnmass_letters, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> letter), <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb196-24"><a href="#cb196-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb196-25"><a href="#cb196-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray60"</span>, <span class="st">"darkseagreen"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Ambient"</span>, <span class="st">"Added N"</span>)) <span class="sc">+</span></span>
<span id="cb196-26"><a href="#cb196-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb196-27"><a href="#cb196-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb196-28"><a href="#cb196-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb196-29"><a href="#cb196-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb196-30"><a href="#cb196-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'white'</span>, <span class="at">colour =</span> <span class="st">'black'</span>),</span>
<span id="cb196-31"><a href="#cb196-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">30</span>, <span class="at">colour =</span> <span class="st">'black'</span>),</span>
<span id="cb196-32"><a href="#cb196-32" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">30</span>, <span class="at">colour =</span> <span class="st">'black'</span>),</span>
<span id="cb196-33"><a href="#cb196-33" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">colour =</span> <span class="st">'black'</span>),</span>
<span id="cb196-34"><a href="#cb196-34" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">colour =</span> <span class="st">'black'</span>),</span>
<span id="cb196-35"><a href="#cb196-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'white'</span>, <span class="at">colour =</span> <span class="st">'black'</span>),</span>
<span id="cb196-36"><a href="#cb196-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"white"</span>)) <span class="sc">+</span></span>
<span id="cb196-37"><a href="#cb196-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Soil N"</span>) <span class="sc">+</span></span>
<span id="cb196-38"><a href="#cb196-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="st">'ln '</span> <span class="sc">*</span> <span class="fu">italic</span>(<span class="st">'N'</span>)[<span class="st">'mass'</span>])) <span class="sc">+</span></span>
<span id="cb196-39"><a href="#cb196-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">'P x K treatment'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_errorbar(data = se_table, aes(x = PKgroup, y = lognmass, :
Ignoring unknown aesthetics: fill</code></pre>
</div>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>nmass_violin</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_ydensity()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>nmass_violin <span class="ot">&lt;-</span> nmass_violin <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Helvetica"</span>))</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a><span class="do">############### Save as tiff with 600 dpi </span></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nmass_violin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_ydensity()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
not found in Windows font database
Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
not found in Windows font database
Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
not found in Windows font database</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="do">################################## Tree map N mass ###################################################</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a><span class="fu">calc.relip.mm</span>(leafNmass_lmer)<span class="sc">$</span>lmg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Ntrt_fac                   Ptrt_fac 
               0.052986303                0.020122955 
                  Ktrt_fac                        tmp 
               0.017031194                0.087387355 
                   par2_gs                     loglma 
               0.182182605                0.090385467 
                       chi                    Nfixyes 
               0.251827959                0.096176509 
  photosynthetic_pathwayC4          Ntrt_fac:Ptrt_fac 
               0.065002414                0.010019101 
         Ntrt_fac:Ktrt_fac          Ptrt_fac:Ktrt_fac 
               0.009517314                0.005294481 
Ntrt_fac:Ptrt_fac:Ktrt_fac 
               0.003729046 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>relimp_leafnmass <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>relimp_leafnmass<span class="sc">$</span>Factor <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Soil N'</span>, <span class="st">'Soil P'</span>, <span class="st">'Soil K+µ'</span>, <span class="st">'Tg'</span>, <span class="st">'PAR'</span>, <span class="st">'LMA'</span>, <span class="st">'χ'</span>,</span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'N2 fixation'</span>, <span class="st">'C3/C4'</span>, <span class="st">'Soil Interactions'</span>, <span class="st">'Unexplained'</span>)</span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>relimp_leafnmass<span class="sc">$</span>Importance <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(<span class="fu">c</span>(<span class="fu">calc.relip.mm</span>(leafNmass_lmer)<span class="sc">$</span>lmg[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>], </span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>                                                         <span class="fu">sum</span>(<span class="fu">calc.relip.mm</span>(leafNmass_lmer)<span class="sc">$</span>lmg[<span class="dv">10</span>]),</span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>                                                         <span class="dv">1</span> <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">calc.relip.mm</span>(leafNmass_lmer)<span class="sc">$</span>lmg))))</span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>relimp_leafnmass_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(relimp_leafnmass)</span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a>tm <span class="ot">&lt;-</span> <span class="fu">treemapify</span>(<span class="at">data =</span> relimp_leafnmass_df,</span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">area =</span> <span class="st">"Importance"</span>, <span class="at">start =</span> <span class="st">"topleft"</span>)</span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true" tabindex="-1"></a>tm<span class="sc">$</span>x <span class="ot">&lt;-</span> (tm<span class="sc">$</span>xmax <span class="sc">+</span> tm<span class="sc">$</span>xmin) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb208-13"><a href="#cb208-13" aria-hidden="true" tabindex="-1"></a>tm<span class="sc">$</span>y <span class="ot">&lt;-</span> (tm<span class="sc">$</span>ymax <span class="sc">+</span> tm<span class="sc">$</span>ymin) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb208-14"><a href="#cb208-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-15"><a href="#cb208-15" aria-hidden="true" tabindex="-1"></a>nmass_tm <span class="ot">&lt;-</span> <span class="fu">full_join</span>(relimp_leafnmass_df, tm, <span class="at">by =</span> <span class="st">"Factor"</span>)</span>
<span id="cb208-16"><a href="#cb208-16" aria-hidden="true" tabindex="-1"></a>nmass_tm<span class="sc">$</span>name <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">'Soil~N'</span>, <span class="st">'Soil~P'</span>, <span class="st">'Soil~K[+µ]'</span>, <span class="st">'italic(T)[g]'</span>, <span class="st">'italic(PAR)'</span>,</span>
<span id="cb208-17"><a href="#cb208-17" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'italic(LMA)[]'</span>, <span class="st">'χ'</span>, <span class="st">'N[2]~fixation'</span>, </span>
<span id="cb208-18"><a href="#cb208-18" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'C[3]/C[4]'</span>, <span class="st">'Soil~Interactions'</span>, <span class="st">'Unexplained'</span>)</span>
<span id="cb208-19"><a href="#cb208-19" aria-hidden="true" tabindex="-1"></a>nmass_tm<span class="sc">$</span>slope <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb208-20"><a href="#cb208-20" aria-hidden="true" tabindex="-1"></a>                    <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb208-21"><a href="#cb208-21" aria-hidden="true" tabindex="-1"></a>nmass_tm<span class="sc">$</span>relationship <span class="ot">=</span> nmass_tm<span class="sc">$</span>slope<span class="sc">*</span>nmass_tm<span class="sc">$</span>Importance</span>
<span id="cb208-22"><a href="#cb208-22" aria-hidden="true" tabindex="-1"></a><span class="co">#nmass_tm$slope &lt;- factor(nmass_tm$slope, levels=c("No","negative", "positive"))</span></span>
<span id="cb208-23"><a href="#cb208-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-24"><a href="#cb208-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-25"><a href="#cb208-25" aria-hidden="true" tabindex="-1"></a>nmass_tm_test <span class="ot">&lt;-</span> nmass_tm <span class="sc">%&gt;%</span></span>
<span id="cb208-26"><a href="#cb208-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb208-27"><a href="#cb208-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">Importance =</span> <span class="fu">as.factor</span>(Importance),</span>
<span id="cb208-28"><a href="#cb208-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">slope =</span> <span class="fu">as.factor</span>(slope)</span>
<span id="cb208-29"><a href="#cb208-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb208-30"><a href="#cb208-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-31"><a href="#cb208-31" aria-hidden="true" tabindex="-1"></a>(nmass_treemap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(nmass_tm, </span>
<span id="cb208-32"><a href="#cb208-32" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax, <span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax, </span>
<span id="cb208-33"><a href="#cb208-33" aria-hidden="true" tabindex="-1"></a>                             <span class="at">label =</span> name)) <span class="sc">+</span></span>
<span id="cb208-34"><a href="#cb208-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Importance), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb208-35"><a href="#cb208-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb208-36"><a href="#cb208-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb208-37"><a href="#cb208-37" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb208-38"><a href="#cb208-38" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'white'</span>),</span>
<span id="cb208-39"><a href="#cb208-39" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">'white'</span>),</span>
<span id="cb208-40"><a href="#cb208-40" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">'white'</span>),</span>
<span id="cb208-41"><a href="#cb208-41" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"white"</span>)) <span class="sc">+</span> </span>
<span id="cb208-42"><a href="#cb208-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb208-43"><a href="#cb208-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scale_fill_manual(values = c(positive = "darkblue", negative ="red4", nothing = "lightblue"))+</span></span>
<span id="cb208-44"><a href="#cb208-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"lightcyan2"</span>, <span class="at">high =</span> <span class="st">"lightcyan4"</span>) <span class="sc">+</span></span>
<span id="cb208-45"><a href="#cb208-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb208-46"><a href="#cb208-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(nmass_tm, Factor <span class="sc">==</span> <span class="st">'PAR'</span>), </span>
<span id="cb208-47"><a href="#cb208-47" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">parse =</span> T, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">color=</span><span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb208-48"><a href="#cb208-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb208-49"><a href="#cb208-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(nmass_tm, Factor <span class="sc">==</span> <span class="st">'LMA'</span>), </span>
<span id="cb208-50"><a href="#cb208-50" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">parse =</span> T, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">color=</span><span class="st">"red3"</span>) <span class="sc">+</span></span>
<span id="cb208-51"><a href="#cb208-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb208-52"><a href="#cb208-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(nmass_tm, Factor <span class="sc">==</span> <span class="st">'χ'</span>), </span>
<span id="cb208-53"><a href="#cb208-53" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"red3"</span>, <span class="at">label=</span><span class="fu">expression</span>(chi)) <span class="sc">+</span></span>
<span id="cb208-54"><a href="#cb208-54" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb208-55"><a href="#cb208-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(nmass_tm, Factor <span class="sc">==</span> <span class="st">'N2 fixation'</span>), </span>
<span id="cb208-56"><a href="#cb208-56" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">parse =</span> T, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">color=</span><span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb208-57"><a href="#cb208-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb208-58"><a href="#cb208-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb208-59"><a href="#cb208-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(nmass_tm, Factor <span class="sc">==</span> <span class="st">'Unexplained'</span>), </span>
<span id="cb208-60"><a href="#cb208-60" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">parse =</span> T, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb208-61"><a href="#cb208-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb208-62"><a href="#cb208-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(nmass_tm, Factor <span class="sc">==</span> <span class="st">'Tg'</span>), </span>
<span id="cb208-63"><a href="#cb208-63" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">color=</span><span class="st">"red3"</span>) <span class="sc">+</span></span>
<span id="cb208-64"><a href="#cb208-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb208-65"><a href="#cb208-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(nmass_tm,  Factor <span class="sc">==</span> <span class="st">'C3/C4'</span>), </span>
<span id="cb208-66"><a href="#cb208-66" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">parse =</span> T, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">color=</span><span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb208-67"><a href="#cb208-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb208-68"><a href="#cb208-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(nmass_tm,  Factor <span class="sc">==</span> <span class="st">'Soil N'</span>), </span>
<span id="cb208-69"><a href="#cb208-69" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">parse =</span> T, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">color=</span><span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb208-70"><a href="#cb208-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb208-71"><a href="#cb208-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(nmass_tm,  Factor <span class="sc">==</span> <span class="st">'Soil Interactions'</span>), </span>
<span id="cb208-72"><a href="#cb208-72" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">parse =</span> T, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb208-73"><a href="#cb208-73" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb208-74"><a href="#cb208-74" aria-hidden="true" tabindex="-1"></a>    ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">data =</span> <span class="fu">filter</span>(nmass_tm, Factor <span class="sc">==</span> <span class="st">'Soil P'</span> <span class="sc">|</span></span>
<span id="cb208-75"><a href="#cb208-75" aria-hidden="true" tabindex="-1"></a>                                             Factor <span class="sc">==</span> <span class="st">'Soil K+µ'</span>), </span>
<span id="cb208-76"><a href="#cb208-76" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">parse =</span> T, <span class="at">size =</span> <span class="dv">5</span>, </span>
<span id="cb208-77"><a href="#cb208-77" aria-hidden="true" tabindex="-1"></a>                             <span class="at">direction =</span> <span class="st">"y"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">1.01</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb208-78"><a href="#cb208-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb208-79"><a href="#cb208-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.2</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb208-80"><a href="#cb208-80" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">"X (\U03C7)"</span>) <span class="sc">+</span></span>
<span id="cb208-81"><a href="#cb208-81" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scale_x_continuous(limits = c(0, 1.2), expand = c(0, 0)) +</span></span>
<span id="cb208-82"><a href="#cb208-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in is.na(x): is.na() applied to non-(list or vector) of type
'expression'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>nmass_treemap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in is.na(x): is.na() applied to non-(list or vector) of type
'expression'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>nmass_treemap <span class="ot">&lt;-</span> nmass_treemap <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Helvetica"</span>))</span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nmass_treemap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in is.na(x): is.na() applied to non-(list or vector) of type
'expression'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
not found in Windows font database
Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
not found in Windows font database</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="do">### linear mixed effects model for Narea ####################</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="do">###############################################################################</span></span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(leaf_analysis<span class="sc">$</span>lognarea) <span class="co"># normal distribution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>leafnarea_lmer <span class="ot">&lt;-</span> <span class="fu">lmer</span>(lognarea <span class="sc">~</span> Ntrt_fac <span class="sc">*</span> Ptrt_fac <span class="sc">*</span> Ktrt_fac <span class="sc">+</span> tmp <span class="sc">+</span> </span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>                         par2_gs <span class="sc">+</span> loglma <span class="sc">+</span> chi <span class="sc">+</span> Nfix <span class="sc">+</span> photosynthetic_pathway <span class="sc">+</span></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">|</span>Taxon) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Taxon<span class="sc">:</span>site_code) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Taxon<span class="sc">:</span>site_code<span class="sc">:</span>block_fac), </span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> leaf_analysis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Some predictor variables are on very different scales: consider
rescaling</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">resid</span>(leafnarea_lmer) <span class="sc">~</span> <span class="fu">fitted</span>(leafnarea_lmer))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(leafnarea_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: lognarea ~ Ntrt_fac * Ptrt_fac * Ktrt_fac + tmp + par2_gs + loglma +  
    chi + Nfix + photosynthetic_pathway + (1 | Taxon) + (1 |  
    Taxon:site_code) + (1 | Taxon:site_code:block_fac)
   Data: leaf_analysis

REML criterion at convergence: 199.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.6743 -0.5327  0.0282  0.5376  3.5023 

Random effects:
 Groups                    Name        Variance Std.Dev.
 Taxon:site_code:block_fac (Intercept) 0.01251  0.1118  
 Taxon:site_code           (Intercept) 0.07550  0.2748  
 Taxon                     (Intercept) 0.00000  0.0000  
 Residual                              0.04115  0.2029  
Number of obs: 1518, groups:  
Taxon:site_code:block_fac, 445; Taxon:site_code, 233; Taxon, 186

Fixed effects:
                              Estimate Std. Error t value
(Intercept)                 -3.3208327  0.1746818 -19.011
Ntrt_fac1                    0.2074462  0.0225771   9.188
Ptrt_fac                     0.0341752  0.0220954   1.547
Ktrt_fac                     0.0037938  0.0222900   0.170
tmp                         -0.0262867  0.0059359  -4.428
par2_gs                      0.0003999  0.0001341   2.982
loglma                       0.9445727  0.0111941  84.381
chi                         -0.2433157  0.1139732  -2.135
Nfixyes                      0.4837340  0.0657074   7.362
photosynthetic_pathwayC4    -0.5724616  0.0855574  -6.691
Ntrt_fac1:Ptrt_fac          -0.0616127  0.0315520  -1.953
Ntrt_fac1:Ktrt_fac           0.0002368  0.0314950   0.008
Ptrt_fac:Ktrt_fac            0.0115212  0.0312845   0.368
Ntrt_fac1:Ptrt_fac:Ktrt_fac -0.0262289  0.0444650  -0.590</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Correlation matrix not shown by default, as p = 14 &gt; 12.
Use print(x, correlation=TRUE)  or
    vcov(x)        if you need it</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>fit warnings:
Some predictor variables are on very different scales: consider rescaling
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(leafnarea_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II Wald chisquare tests)

Response: lognarea
                               Chisq Df Pr(&gt;Chisq)    
Ntrt_fac                    225.2272  1  &lt; 2.2e-16 ***
Ptrt_fac                      0.0582  1  0.8092926    
Ktrt_fac                      0.0847  1  0.7709746    
tmp                          19.6112  1  9.491e-06 ***
par2_gs                       8.8907  1  0.0028662 ** 
loglma                     7120.2065  1  &lt; 2.2e-16 ***
chi                           4.5576  1  0.0327732 *  
Nfix                         54.1981  1  1.813e-13 ***
photosynthetic_pathway       44.7690  1  2.217e-11 ***
Ntrt_fac:Ptrt_fac            11.4504  1  0.0007148 ***
Ntrt_fac:Ktrt_fac             0.3344  1  0.5630527    
Ptrt_fac:Ktrt_fac             0.0045  1  0.9462304    
Ntrt_fac:Ptrt_fac:Ktrt_fac    0.3480  1  0.5552731    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(leafnarea_lmer) <span class="do">## 235.448</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 235.4489</code></pre>
</div>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(leafnarea_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Ntrt_fac                   Ptrt_fac 
                  4.028517                   3.929380 
                  Ktrt_fac                        tmp 
                  3.965085                   1.152850 
                   par2_gs                     loglma 
                  1.021652                   1.026431 
                       chi                       Nfix 
                  1.129423                   1.020303 
    photosynthetic_pathway          Ntrt_fac:Ptrt_fac 
                  1.262423                   5.918243 
         Ntrt_fac:Ktrt_fac          Ptrt_fac:Ktrt_fac 
                  5.937819                   5.936071 
Ntrt_fac:Ptrt_fac:Ktrt_fac 
                  6.848896 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(leafnarea_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-15.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(leafnarea_lmer))</span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(leafnarea_lmer))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-16.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">densityPlot</span>(<span class="fu">residuals</span>(leafnarea_lmer))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-17.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(leafnarea_lmer))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(leafnarea_lmer)
W = 0.9922, p-value = 3.366e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">outlierTest</span>(leafnarea_lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>No Studentized residuals with Bonferroni p &lt; 0.05
Largest |rstudent|:
    rstudent unadjusted p-value Bonferroni p
699 4.138513           3.69e-05     0.056015</code></pre>
</div>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> <span class="fu">resid</span>(leafnarea_lmer)</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(residuals, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">"Histogram of Residuals"</span>) <span class="do">## good</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-18.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(leafnarea_lmer), residuals, <span class="at">xlab =</span> <span class="st">"Fitted Values"</span>, <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Residuals vs. Fitted Values"</span>)  <span class="co"># heteroscedasticity : high, when fitted values are high </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-19.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r.squaredGLMM</span>(leafnarea_lmer) <span class="do">## Conditional : 0.96, marginal: 0.87</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in Taxon:site_code:block_fac: numerical expression has 1518 elements:
only the first used</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>           R2m       R2c
[1,] 0.8716891 0.9591185</code></pre>
</div>
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="do">########### Export model ###########################################</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>Narea_model <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Var =</span> <span class="fu">c</span>(<span class="st">'Soil N'</span>, <span class="st">'Soil P'</span>, <span class="st">'Soil K+µ'</span>, <span class="st">'Tg'</span>, </span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'PAR'</span>, <span class="st">'ln LMA'</span>, <span class="st">'χ'</span>, <span class="st">'N fixer'</span>, <span class="st">'C3/C4'</span>,</span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'Soil N x Soil P'</span>, <span class="st">'Soil N x Soil K'</span>, <span class="st">'Soil P x Soil K'</span>,</span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'Soil N x Soil P x Soil K'</span>))</span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a>Narea_model<span class="sc">$</span>df <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">Anova</span>(leafnarea_lmer))[<span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>, <span class="dv">2</span>]</span>
<span id="cb243-7"><a href="#cb243-7" aria-hidden="true" tabindex="-1"></a>Narea_model<span class="sc">$</span>Slope <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,</span>
<span id="cb243-8"><a href="#cb243-8" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">summary</span>(<span class="fu">emtrends</span>(leafnarea_lmer, <span class="sc">~</span>tmp, <span class="at">var =</span> <span class="st">"tmp"</span>))[<span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb243-9"><a href="#cb243-9" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">summary</span>(<span class="fu">emtrends</span>(leafnarea_lmer, <span class="sc">~</span>par2_gs, <span class="at">var =</span> <span class="st">"par2_gs"</span>))[<span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb243-10"><a href="#cb243-10" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">summary</span>(<span class="fu">emtrends</span>(leafnarea_lmer, <span class="sc">~</span>loglma, <span class="at">var =</span> <span class="st">"loglma"</span>))[<span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb243-11"><a href="#cb243-11" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">summary</span>(<span class="fu">emtrends</span>(leafnarea_lmer, <span class="sc">~</span>chi, <span class="at">var =</span> <span class="st">"chi"</span>))[<span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb243-12"><a href="#cb243-12" aria-hidden="true" tabindex="-1"></a>                       <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb243-13"><a href="#cb243-13" aria-hidden="true" tabindex="-1"></a>Narea_model<span class="sc">$</span>SE <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,</span>
<span id="cb243-14"><a href="#cb243-14" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">summary</span>(<span class="fu">emtrends</span>(leafnarea_lmer, <span class="sc">~</span>tmp, <span class="at">var =</span> <span class="st">"tmp"</span>))[<span class="dv">1</span>, <span class="dv">3</span>],</span>
<span id="cb243-15"><a href="#cb243-15" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">summary</span>(<span class="fu">emtrends</span>(leafnarea_lmer, <span class="sc">~</span>par2_gs, <span class="at">var =</span> <span class="st">"par2_gs"</span>))[<span class="dv">1</span>, <span class="dv">3</span>],</span>
<span id="cb243-16"><a href="#cb243-16" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">summary</span>(<span class="fu">emtrends</span>(leafnarea_lmer, <span class="sc">~</span>loglma, <span class="at">var =</span> <span class="st">"loglma"</span>))[<span class="dv">1</span>, <span class="dv">3</span>],</span>
<span id="cb243-17"><a href="#cb243-17" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">summary</span>(<span class="fu">emtrends</span>(leafnarea_lmer, <span class="sc">~</span>chi, <span class="at">var =</span> <span class="st">"chi"</span>))[<span class="dv">1</span>, <span class="dv">3</span>],</span>
<span id="cb243-18"><a href="#cb243-18" aria-hidden="true" tabindex="-1"></a>                    <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb243-19"><a href="#cb243-19" aria-hidden="true" tabindex="-1"></a>Narea_model<span class="sc">$</span>p <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">Anova</span>(leafnarea_lmer))[<span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>, <span class="dv">3</span>]</span>
<span id="cb243-20"><a href="#cb243-20" aria-hidden="true" tabindex="-1"></a>Narea_model<span class="sc">$</span>RelImp <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">calc.relip.mm</span>(leafnarea_lmer)<span class="sc">$</span>lmg)[<span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>]</span>
<span id="cb243-21"><a href="#cb243-21" aria-hidden="true" tabindex="-1"></a>Narea_model<span class="sc">$</span>RelImp <span class="ot">&lt;-</span> Narea_model<span class="sc">$</span>RelImp <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb243-22"><a href="#cb243-22" aria-hidden="true" tabindex="-1"></a>Narea_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Var df         Slope           SE            p
1                    Soil N  1            NA           NA 6.550193e-51
2                    Soil P  1            NA           NA 8.092926e-01
3                  Soil K+µ  1            NA           NA 7.709746e-01
4                        Tg  1 -0.0262867434 0.0059909594 9.491282e-06
5                       PAR  1  0.0003998939 0.0001352872 2.866204e-03
6                    ln LMA  1  0.9445727008 0.0112452917 0.000000e+00
7                         χ  1 -0.2433156658 0.1144335476 3.277321e-02
8                   N fixer  1            NA           NA 1.812630e-13
9                     C3/C4  1            NA           NA 2.217041e-11
10          Soil N x Soil P  1            NA           NA 7.147951e-04
11          Soil N x Soil K  1            NA           NA 5.630527e-01
12          Soil P x Soil K  1            NA           NA 9.462304e-01
13 Soil N x Soil P x Soil K  1            NA           NA 5.552731e-01
       RelImp
1   0.8114004
2   0.9982018
3   1.0944327
4   4.8418978
5   6.6824121
6  45.6442818
7  18.7155911
8   2.0456989
9   5.6483738
10  0.3867644
11  0.4740641
12  0.4236881
13  0.2573710</code></pre>
</div>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="do">################################# Figure comparison between treatments ######################## </span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a><span class="do">#### soil nitrogen effect</span></span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a><span class="co"># percentage increase of Narea in plots receiving N compared to plots not receiving N</span></span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a>(<span class="fu">summary</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>Ntrt_fac))[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">summary</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>Ntrt_fac))[<span class="dv">1</span>,<span class="dv">2</span>])<span class="sc">/</span></span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>Ntrt_fac))[<span class="dv">1</span>,<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: Results may be misleading due to involvement in interactions
NOTE: Results may be misleading due to involvement in interactions
NOTE: Results may be misleading due to involvement in interactions</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2244203</code></pre>
</div>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.2244</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a><span class="co"># percentage increase of Narea in plots receiving N but not P compared to plots not receiving N or P</span></span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a>(<span class="fu">summary</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac))[<span class="dv">2</span>,<span class="dv">3</span>] <span class="sc">-</span> <span class="fu">summary</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac))[<span class="dv">1</span>,<span class="dv">3</span>])<span class="sc">/</span></span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac))[<span class="dv">1</span>,<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: Results may be misleading due to involvement in interactions
NOTE: Results may be misleading due to involvement in interactions
NOTE: Results may be misleading due to involvement in interactions</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2810871</code></pre>
</div>
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.2810871</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a><span class="co"># percentage increase of Narea in plots receiving N and P compared to plots receiving P but not N</span></span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>(<span class="fu">summary</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac))[<span class="dv">4</span>,<span class="dv">3</span>] <span class="sc">-</span> <span class="fu">summary</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac))[<span class="dv">3</span>,<span class="dv">3</span>])<span class="sc">/</span></span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac))[<span class="dv">3</span>,<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: Results may be misleading due to involvement in interactions
NOTE: Results may be misleading due to involvement in interactions
NOTE: Results may be misleading due to involvement in interactions</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1706608</code></pre>
</div>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.1706608</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a><span class="co"># percentage increase of Narea in N fixers compared to non-N fixers</span></span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>(<span class="fu">summary</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>Nfix))[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">summary</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>Nfix))[<span class="dv">1</span>,<span class="dv">2</span>])<span class="sc">/</span></span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>Nfix))[<span class="dv">1</span>,<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8040299</code></pre>
</div>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.8040299</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a><span class="co"># percentage increase of Narea in C3s compared to C4s</span></span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>(<span class="fu">summary</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>photosynthetic_pathway))[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">summary</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>photosynthetic_pathway))[<span class="dv">2</span>,<span class="dv">2</span>])<span class="sc">/</span></span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>photosynthetic_pathway))[<span class="dv">2</span>,<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.027255</code></pre>
</div>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.027255</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>leaf_analysis<span class="sc">$</span>PKgroup[leaf_analysis<span class="sc">$</span>Ptrt_fac <span class="sc">==</span> <span class="st">'0'</span> <span class="sc">&amp;</span> leaf_analysis<span class="sc">$</span>Ktrt_fac <span class="sc">==</span> <span class="st">'0'</span>] <span class="ot">&lt;-</span> <span class="st">'-P, -K+µ'</span></span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a>leaf_analysis<span class="sc">$</span>PKgroup[leaf_analysis<span class="sc">$</span>Ptrt_fac <span class="sc">==</span> <span class="st">'1'</span> <span class="sc">&amp;</span> leaf_analysis<span class="sc">$</span>Ktrt_fac <span class="sc">==</span> <span class="st">'0'</span>] <span class="ot">&lt;-</span> <span class="st">'+P, -K+µ'</span></span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a>leaf_analysis<span class="sc">$</span>PKgroup[leaf_analysis<span class="sc">$</span>Ptrt_fac <span class="sc">==</span> <span class="st">'0'</span> <span class="sc">&amp;</span> leaf_analysis<span class="sc">$</span>Ktrt_fac <span class="sc">==</span> <span class="st">'1'</span>] <span class="ot">&lt;-</span> <span class="st">'-P, +K+µ'</span></span>
<span id="cb258-6"><a href="#cb258-6" aria-hidden="true" tabindex="-1"></a>leaf_analysis<span class="sc">$</span>PKgroup[leaf_analysis<span class="sc">$</span>Ptrt_fac <span class="sc">==</span> <span class="st">'1'</span> <span class="sc">&amp;</span> leaf_analysis<span class="sc">$</span>Ktrt_fac <span class="sc">==</span> <span class="st">'1'</span>] <span class="ot">&lt;-</span> <span class="st">'+P, +K+µ'</span></span>
<span id="cb258-7"><a href="#cb258-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-8"><a href="#cb258-8" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> <span class="fu">cld</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac <span class="sc">*</span> Ktrt_fac)) <span class="do">## comp slopes : plots receiving N higher than those which did not</span></span>
<span id="cb258-9"><a href="#cb258-9" aria-hidden="true" tabindex="-1"></a>test<span class="sc">$</span>.group</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] " 1 " " 1 " " 1 " " 1 " "  2" "  2" "  2" "  2"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>leafnarea_letters <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">1.2</span>, <span class="fl">1.8</span>, <span class="fl">2.2</span>, <span class="fl">2.8</span>, <span class="fl">3.2</span>, <span class="fl">3.8</span>, <span class="fl">4.2</span>),</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">NPgroup =</span> <span class="fu">c</span>(<span class="st">'-P, -K+µ'</span>, <span class="st">'-P, -K+µ'</span>, <span class="st">'+P, -K+µ'</span>, <span class="st">'+P, -K+µ'</span>, </span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">'-P, +K+µ'</span>, <span class="st">'-P, +K+µ'</span>, <span class="st">'+P, +K+µ'</span>, <span class="st">'+P, +K+µ'</span>),</span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">Ntrt_fac =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">6.5</span>, <span class="fl">6.5</span>, <span class="fl">6.5</span>, <span class="fl">6.5</span>, <span class="fl">6.5</span>, <span class="fl">6.5</span>, <span class="fl">6.5</span>, <span class="fl">6.5</span>), </span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a>                                <span class="at">group =</span> <span class="fu">c</span>(<span class="fu">cld</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac <span class="sc">*</span> Ktrt_fac))[<span class="dv">1</span>, <span class="dv">9</span>],</span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">cld</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac <span class="sc">*</span> Ktrt_fac))[<span class="dv">7</span>, <span class="dv">9</span>],</span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">cld</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac <span class="sc">*</span> Ktrt_fac))[<span class="dv">3</span>, <span class="dv">9</span>],</span>
<span id="cb260-9"><a href="#cb260-9" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">cld</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac <span class="sc">*</span> Ktrt_fac))[<span class="dv">6</span>, <span class="dv">9</span>],</span>
<span id="cb260-10"><a href="#cb260-10" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">cld</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac <span class="sc">*</span> Ktrt_fac))[<span class="dv">2</span>, <span class="dv">9</span>],</span>
<span id="cb260-11"><a href="#cb260-11" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">cld</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac <span class="sc">*</span> Ktrt_fac))[<span class="dv">8</span>, <span class="dv">9</span>],</span>
<span id="cb260-12"><a href="#cb260-12" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">cld</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac <span class="sc">*</span> Ktrt_fac))[<span class="dv">4</span>, <span class="dv">9</span>],</span>
<span id="cb260-13"><a href="#cb260-13" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">cld</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ptrt_fac <span class="sc">*</span> Ktrt_fac))[<span class="dv">5</span>, <span class="dv">9</span>]))</span>
<span id="cb260-14"><a href="#cb260-14" aria-hidden="true" tabindex="-1"></a>leafnarea_letters<span class="sc">$</span>Ntrt_fac <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(leafnarea_letters<span class="sc">$</span>Ntrt_fac)</span>
<span id="cb260-15"><a href="#cb260-15" aria-hidden="true" tabindex="-1"></a>leafnarea_letters<span class="sc">$</span>letter[leafnarea_letters<span class="sc">$</span>group <span class="sc">==</span> <span class="st">" 1 "</span>] <span class="ot">&lt;-</span> <span class="st">"a"</span></span>
<span id="cb260-16"><a href="#cb260-16" aria-hidden="true" tabindex="-1"></a>leafnarea_letters<span class="sc">$</span>letter[leafnarea_letters<span class="sc">$</span>group <span class="sc">==</span> <span class="st">"  2"</span>] <span class="ot">&lt;-</span> <span class="st">"b"</span></span>
<span id="cb260-17"><a href="#cb260-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-18"><a href="#cb260-18" aria-hidden="true" tabindex="-1"></a><span class="do">#### Regression table emmeans + SE </span></span>
<span id="cb260-19"><a href="#cb260-19" aria-hidden="true" tabindex="-1"></a>se_table <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">emmeans</span>(leafnarea_lmer, <span class="sc">~</span>Ntrt_fac <span class="sc">*</span> Ktrt_fac <span class="sc">*</span> Ptrt_fac))</span>
<span id="cb260-20"><a href="#cb260-20" aria-hidden="true" tabindex="-1"></a>se_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Ntrt_fac Ktrt_fac Ptrt_fac emmean     SE  df lower.CL upper.CL
 0               0        0  0.737 0.0529 218    0.632    0.841
 1               0        0  0.944 0.0539 234    0.838    1.050
 0               1        0  0.740 0.0529 221    0.636    0.845
 1               1        0  0.948 0.0532 226    0.843    1.053
 0               0        1  0.771 0.0531 224    0.666    0.875
 1               0        1  0.917 0.0536 229    0.811    1.022
 0               1        1  0.786 0.0525 215    0.682    0.890
 1               1        1  0.906 0.0535 229    0.800    1.011

Results are averaged over the levels of: Nfix, photosynthetic_pathway 
Degrees-of-freedom method: kenward-roger 
Confidence level used: 0.95 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a>se_table <span class="ot">=</span> <span class="fu">as.data.frame</span>(se_table)</span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a>se_table<span class="sc">$</span>PKgroup[se_table<span class="sc">$</span>Ptrt_fac <span class="sc">==</span> <span class="st">'0'</span> <span class="sc">&amp;</span> se_table<span class="sc">$</span>Ktrt_fac <span class="sc">==</span> <span class="st">'0'</span>] <span class="ot">&lt;-</span> <span class="st">'-P, -K+µ'</span></span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a>se_table<span class="sc">$</span>PKgroup[se_table<span class="sc">$</span>Ptrt_fac <span class="sc">==</span> <span class="st">'1'</span> <span class="sc">&amp;</span> se_table<span class="sc">$</span>Ktrt_fac <span class="sc">==</span> <span class="st">'0'</span>] <span class="ot">&lt;-</span> <span class="st">'+P, -K+µ'</span></span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a>se_table<span class="sc">$</span>PKgroup[se_table<span class="sc">$</span>Ptrt_fac <span class="sc">==</span> <span class="st">'0'</span> <span class="sc">&amp;</span> se_table<span class="sc">$</span>Ktrt_fac <span class="sc">==</span> <span class="st">'1'</span>] <span class="ot">&lt;-</span> <span class="st">'-P, +K+µ'</span></span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a>se_table<span class="sc">$</span>PKgroup[se_table<span class="sc">$</span>Ptrt_fac <span class="sc">==</span> <span class="st">'1'</span> <span class="sc">&amp;</span> se_table<span class="sc">$</span>Ktrt_fac <span class="sc">==</span> <span class="st">'1'</span>] <span class="ot">&lt;-</span> <span class="st">'+P, +K+µ'</span></span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(se_table)[<span class="fu">which</span>(<span class="fu">names</span>(se_table) <span class="sc">==</span> <span class="st">"emmean"</span>)] <span class="ot">&lt;-</span> <span class="st">"lognarea"</span></span>
<span id="cb262-8"><a href="#cb262-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-9"><a href="#cb262-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-10"><a href="#cb262-10" aria-hidden="true" tabindex="-1"></a><span class="do">################ Narea violin plot + emmean and SE ################################################</span></span>
<span id="cb262-11"><a href="#cb262-11" aria-hidden="true" tabindex="-1"></a>leaf_analysis<span class="sc">$</span>Ntrt_fac <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(leaf_analysis<span class="sc">$</span>Ntrt_fac)</span>
<span id="cb262-12"><a href="#cb262-12" aria-hidden="true" tabindex="-1"></a>se_table<span class="sc">$</span>Ntrt_fac <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(se_table<span class="sc">$</span>Ntrt_fac)</span>
<span id="cb262-13"><a href="#cb262-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-14"><a href="#cb262-14" aria-hidden="true" tabindex="-1"></a>narea_violin <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> leaf_analysis, </span>
<span id="cb262-15"><a href="#cb262-15" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> PKgroup, <span class="at">y =</span> lognarea, <span class="at">fill =</span> Ntrt_fac),<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>), <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb262-16"><a href="#cb262-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim=</span><span class="cn">FALSE</span>, <span class="at">outlier.color =</span> <span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb262-17"><a href="#cb262-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> se_table, <span class="fu">aes</span>(<span class="at">x =</span> PKgroup, <span class="at">y =</span> lognarea, <span class="at">fill =</span> Ntrt_fac), </span>
<span id="cb262-18"><a href="#cb262-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb262-19"><a href="#cb262-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb262-20"><a href="#cb262-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data =</span> se_table, <span class="fu">aes</span>(<span class="at">x =</span> PKgroup, <span class="at">y =</span> lognarea, <span class="at">ymin =</span> lognarea <span class="sc">-</span> SE, <span class="at">ymax =</span> lognarea <span class="sc">+</span> SE, </span>
<span id="cb262-21"><a href="#cb262-21" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">fill =</span> Ntrt_fac), <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb262-22"><a href="#cb262-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb262-23"><a href="#cb262-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> leafnarea_letters, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> letter), <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb262-24"><a href="#cb262-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb262-25"><a href="#cb262-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray60"</span>, <span class="st">"darkseagreen"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Ambient"</span>, <span class="st">"Added N"</span>)) <span class="sc">+</span></span>
<span id="cb262-26"><a href="#cb262-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb262-27"><a href="#cb262-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb262-28"><a href="#cb262-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb262-29"><a href="#cb262-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb262-30"><a href="#cb262-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'white'</span>, <span class="at">colour =</span> <span class="st">'black'</span>),</span>
<span id="cb262-31"><a href="#cb262-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">30</span>, <span class="at">colour =</span> <span class="st">'black'</span>),</span>
<span id="cb262-32"><a href="#cb262-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">30</span>, <span class="at">colour =</span> <span class="st">'black'</span>),</span>
<span id="cb262-33"><a href="#cb262-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">colour =</span> <span class="st">'black'</span>),</span>
<span id="cb262-34"><a href="#cb262-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">colour =</span> <span class="st">'black'</span>),</span>
<span id="cb262-35"><a href="#cb262-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'white'</span>, <span class="at">colour =</span> <span class="st">'black'</span>),</span>
<span id="cb262-36"><a href="#cb262-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"white"</span>)) <span class="sc">+</span></span>
<span id="cb262-37"><a href="#cb262-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Soil N"</span>) <span class="sc">+</span></span>
<span id="cb262-38"><a href="#cb262-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="st">'ln '</span> <span class="sc">*</span> <span class="fu">italic</span>(<span class="st">'N'</span>)[<span class="st">'area'</span>])) <span class="sc">+</span></span>
<span id="cb262-39"><a href="#cb262-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'P x K treatment'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_violin(trim = FALSE, outlier.color = NA): Ignoring unknown
parameters: `outlier.colour`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_errorbar(data = se_table, aes(x = PKgroup, y = lognarea, :
Ignoring unknown aesthetics: fill</code></pre>
</div>
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a>narea_violin</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 234 rows containing non-finite outside the scale range
(`stat_ydensity()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-20.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>narea_violin <span class="ot">&lt;-</span> narea_violin <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Helvetica"</span>))</span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(narea_violin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 234 rows containing non-finite outside the scale range
(`stat_ydensity()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-21.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="do">################################## Tree map Narea ###################################################</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a><span class="fu">calc.relip.mm</span>(leafnarea_lmer)<span class="sc">$</span>lmg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Ntrt_fac1                    Ptrt_fac 
                0.008114004                 0.009982018 
                   Ktrt_fac                         tmp 
                0.010944327                 0.048418978 
                    par2_gs                      loglma 
                0.066824121                 0.456442818 
                        chi                     Nfixyes 
                0.187155911                 0.020456989 
   photosynthetic_pathwayC4          Ntrt_fac1:Ptrt_fac 
                0.056483738                 0.003867644 
         Ntrt_fac1:Ktrt_fac           Ptrt_fac:Ktrt_fac 
                0.004740641                 0.004236881 
Ntrt_fac1:Ptrt_fac:Ktrt_fac 
                0.002573710 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>relimp_leafnarea<span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a>relimp_leafnarea<span class="sc">$</span>Factor <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Soil N'</span>, <span class="st">'Soil P'</span>, <span class="st">'Soil K+µ'</span>, <span class="st">'Tg'</span>, <span class="st">'PAR'</span>, <span class="st">'LMA'</span>, <span class="st">'χ'</span>,</span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'N2 fixation'</span>, <span class="st">'C3/C4'</span>, <span class="st">'Soil Interactions'</span>, <span class="st">'Unexplained'</span>)</span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a>relimp_leafnarea<span class="sc">$</span>Importance <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(<span class="fu">c</span>(<span class="fu">calc.relip.mm</span>(leafnarea_lmer)<span class="sc">$</span>lmg[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>], </span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a>                                                         <span class="fu">sum</span>(<span class="fu">calc.relip.mm</span>(leafnarea_lmer)<span class="sc">$</span>lmg[<span class="dv">10</span><span class="sc">:</span><span class="dv">13</span>]),</span>
<span id="cb273-6"><a href="#cb273-6" aria-hidden="true" tabindex="-1"></a>                                                         <span class="dv">1</span> <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">calc.relip.mm</span>(leafnarea_lmer)<span class="sc">$</span>lmg))))</span>
<span id="cb273-7"><a href="#cb273-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-8"><a href="#cb273-8" aria-hidden="true" tabindex="-1"></a>relimp_leafnarea_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(relimp_leafnarea)</span>
<span id="cb273-9"><a href="#cb273-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-10"><a href="#cb273-10" aria-hidden="true" tabindex="-1"></a>tm <span class="ot">&lt;-</span> <span class="fu">treemapify</span>(<span class="at">data =</span> relimp_leafnarea_df,</span>
<span id="cb273-11"><a href="#cb273-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">area =</span> <span class="st">"Importance"</span>, <span class="at">start =</span> <span class="st">"topleft"</span>)</span>
<span id="cb273-12"><a href="#cb273-12" aria-hidden="true" tabindex="-1"></a>tm<span class="sc">$</span>x <span class="ot">&lt;-</span> (tm<span class="sc">$</span>xmax <span class="sc">+</span> tm<span class="sc">$</span>xmin) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb273-13"><a href="#cb273-13" aria-hidden="true" tabindex="-1"></a>tm<span class="sc">$</span>y <span class="ot">&lt;-</span> (tm<span class="sc">$</span>ymax <span class="sc">+</span> tm<span class="sc">$</span>ymin) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb273-14"><a href="#cb273-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-15"><a href="#cb273-15" aria-hidden="true" tabindex="-1"></a>narea_tm <span class="ot">&lt;-</span> <span class="fu">full_join</span>(relimp_leafnarea_df, tm, <span class="at">by =</span> <span class="st">"Factor"</span>)</span>
<span id="cb273-16"><a href="#cb273-16" aria-hidden="true" tabindex="-1"></a>narea_tm<span class="sc">$</span>name <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">'Soil~N'</span>, <span class="st">'Soil~P'</span>, <span class="st">'Soil~K[+µ]'</span>, <span class="st">'italic(T)[g]'</span>, <span class="st">'italic(PAR)'</span>,</span>
<span id="cb273-17"><a href="#cb273-17" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'italic(LMA)[]'</span>, <span class="st">'italic(χ)'</span>, <span class="st">'N[2]~fixation'</span>, </span>
<span id="cb273-18"><a href="#cb273-18" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'C[3]/C[4]'</span>, <span class="st">'Soil~Interactions'</span>, <span class="st">'Unexplained'</span>)</span>
<span id="cb273-19"><a href="#cb273-19" aria-hidden="true" tabindex="-1"></a>narea_tm<span class="sc">$</span>slope <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb273-20"><a href="#cb273-20" aria-hidden="true" tabindex="-1"></a>                    <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb273-21"><a href="#cb273-21" aria-hidden="true" tabindex="-1"></a>narea_tm<span class="sc">$</span>relationship <span class="ot">=</span> narea_tm<span class="sc">$</span>slope<span class="sc">*</span>narea_tm<span class="sc">$</span>Importance</span>
<span id="cb273-22"><a href="#cb273-22" aria-hidden="true" tabindex="-1"></a><span class="co">#nmass_tm$slope &lt;- factor(nmass_tm$slope, levels=c("No","negative", "positive"))</span></span>
<span id="cb273-23"><a href="#cb273-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-24"><a href="#cb273-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-25"><a href="#cb273-25" aria-hidden="true" tabindex="-1"></a>narea_tm_test <span class="ot">&lt;-</span> narea_tm <span class="sc">%&gt;%</span></span>
<span id="cb273-26"><a href="#cb273-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb273-27"><a href="#cb273-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">Importance =</span> <span class="fu">as.factor</span>(Importance),</span>
<span id="cb273-28"><a href="#cb273-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">slope =</span> <span class="fu">as.factor</span>(slope)</span>
<span id="cb273-29"><a href="#cb273-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb273-30"><a href="#cb273-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-31"><a href="#cb273-31" aria-hidden="true" tabindex="-1"></a>(narea_treemap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(narea_tm, </span>
<span id="cb273-32"><a href="#cb273-32" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax, <span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax, </span>
<span id="cb273-33"><a href="#cb273-33" aria-hidden="true" tabindex="-1"></a>                             <span class="at">label =</span> name)) <span class="sc">+</span></span>
<span id="cb273-34"><a href="#cb273-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Importance), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb273-35"><a href="#cb273-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb273-36"><a href="#cb273-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb273-37"><a href="#cb273-37" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb273-38"><a href="#cb273-38" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'white'</span>),</span>
<span id="cb273-39"><a href="#cb273-39" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">'white'</span>),</span>
<span id="cb273-40"><a href="#cb273-40" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">'white'</span>),</span>
<span id="cb273-41"><a href="#cb273-41" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"white"</span>)) <span class="sc">+</span> </span>
<span id="cb273-42"><a href="#cb273-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb273-43"><a href="#cb273-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scale_fill_manual(values = c(positive = "darkblue", negative ="red4", nothing = "lightblue"))+</span></span>
<span id="cb273-44"><a href="#cb273-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"lightcyan2"</span>, <span class="at">high =</span> <span class="st">"lightcyan4"</span>) <span class="sc">+</span></span>
<span id="cb273-45"><a href="#cb273-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb273-46"><a href="#cb273-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(narea_tm, Factor <span class="sc">==</span> <span class="st">'LMA'</span>), </span>
<span id="cb273-47"><a href="#cb273-47" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">parse =</span> T, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">color=</span><span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb273-48"><a href="#cb273-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb273-49"><a href="#cb273-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(narea_tm, Factor <span class="sc">==</span> <span class="st">'PAR'</span>), </span>
<span id="cb273-50"><a href="#cb273-50" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">parse =</span> T, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">color=</span><span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb273-51"><a href="#cb273-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb273-52"><a href="#cb273-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(narea_tm, Factor <span class="sc">==</span> <span class="st">'Unexplained'</span>), </span>
<span id="cb273-53"><a href="#cb273-53" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">parse =</span> T, <span class="at">size =</span> <span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb273-54"><a href="#cb273-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb273-55"><a href="#cb273-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(narea_tm, Factor <span class="sc">==</span> <span class="st">'χ'</span>), </span>
<span id="cb273-56"><a href="#cb273-56" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">parse =</span> T, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">color=</span><span class="st">"red3"</span>, <span class="at">label=</span><span class="fu">expression</span>(chi)) <span class="sc">+</span></span>
<span id="cb273-57"><a href="#cb273-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb273-58"><a href="#cb273-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(narea_tm, Factor <span class="sc">==</span> <span class="st">'Tg'</span>), </span>
<span id="cb273-59"><a href="#cb273-59" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">parse =</span> T, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">color=</span><span class="st">"red3"</span>) <span class="sc">+</span></span>
<span id="cb273-60"><a href="#cb273-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb273-61"><a href="#cb273-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(narea_tm,  Factor <span class="sc">==</span> <span class="st">'C3/C4'</span>), </span>
<span id="cb273-62"><a href="#cb273-62" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">parse =</span> T, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">color=</span><span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb273-63"><a href="#cb273-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb273-64"><a href="#cb273-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(narea_tm, Factor <span class="sc">==</span> <span class="st">'N2 fixation'</span>), </span>
<span id="cb273-65"><a href="#cb273-65" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">parse =</span> T, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color=</span><span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb273-66"><a href="#cb273-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb273-67"><a href="#cb273-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(narea_tm,  Factor <span class="sc">==</span> <span class="st">'Soil N'</span>), </span>
<span id="cb273-68"><a href="#cb273-68" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">parse =</span> T, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">color=</span><span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb273-69"><a href="#cb273-69" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb273-70"><a href="#cb273-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(narea_tm,  Factor <span class="sc">==</span> <span class="st">'Soil K+µ'</span>), </span>
<span id="cb273-71"><a href="#cb273-71" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">parse =</span> T, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb273-72"><a href="#cb273-72" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb273-73"><a href="#cb273-73" aria-hidden="true" tabindex="-1"></a>    ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">data =</span> <span class="fu">filter</span>(narea_tm, Factor <span class="sc">==</span> <span class="st">'Soil P'</span> <span class="sc">|</span> Factor <span class="sc">==</span> <span class="st">'Soil Interactions'</span>), </span>
<span id="cb273-74"><a href="#cb273-74" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">parse =</span> T, <span class="at">size =</span> <span class="dv">4</span>, </span>
<span id="cb273-75"><a href="#cb273-75" aria-hidden="true" tabindex="-1"></a>                             <span class="at">direction =</span> <span class="st">"y"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">1.03</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb273-76"><a href="#cb273-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.2</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb273-77"><a href="#cb273-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in is.na(x): is.na() applied to non-(list or vector) of type
'expression'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-22.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>narea_treemap <span class="ot">&lt;-</span> narea_treemap <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Helvetica"</span>))</span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(narea_treemap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in is.na(x): is.na() applied to non-(list or vector) of type
'expression'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database
Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database
Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="复现结果_files/figure-html/unnamed-chunk-2-23.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>